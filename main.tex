\documentclass[a4paper,12pt,oneside]{extbook}
\usepackage{fontspec}
\usepackage[english,russian]{babel}
\usepackage{subcaption}
\usepackage{graphicx}
\usepackage{indentfirst}
\usepackage{caption}
\usepackage{wrapfig}
\usepackage{xcolor,soul,lipsum}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{hyperref}
\usepackage{enumitem} % no item sep in list
\usepackage[explicit]{titlesec}
\usepackage{amssymb}
\usepackage{titletoc}
\usepackage{tocvsec2}
\usepackage{tocloft}
\usepackage[b]{esvect}
\usepackage{mdframed}
\usepackage{textcomp}
\usepackage{multicol}
\usepackage{mathtools}
\usepackage[%
    left=0.8in,%
    right=0.8in,%
    top=0.8in,%
    bottom=1in,%
]{geometry}%


\DeclareMathOperator{\sign}{sign}
% \DeclareMathOperator{\grad}{grad}

\def\lets{%
    \mathord{\setbox0=\hbox{$\exists$}%
        \hbox{\kern 0.125\wd0%
            \vbox to \ht0{%
                \hrule width 0.75\wd0%
                \vfill%
                \hrule width 0.75\wd0}%
            \vrule height \ht0%
            \kern 0.125\wd0}%
    }%
    \hspace{2pt}
}
\newcommand{\linesep}{\noindent\rule{\textwidth}{1pt}}

\makeatletter
\newenvironment{sqcases}{%
    \matrix@check\sqcases\env@sqcases
}{%
    \endarray\right.%
}
\def\env@sqcases{%
\let\@ifnextchar\new@ifnextchar
\left\lbrack
\def\arraystretch{1.2}%
\array{@{}l@{\quad}l@{}}%
}
\makeatother


\newmdenv[
    linewidth=2pt,
    align=center,
    topline=false,
    bottomline=false,
    rightline=false,
    skipabove=\topsep,
    skipbelow=\topsep,
]{siderules}

\providecommand{\pgfsyspdfmark}[3]{}

\newcommand{\newpar}{$ $\par\nobreak\ignorespaces}
\newcommand{\makeline}{\noindent\makebox[\linewidth]{\rule{0.8\paperwidth}{0.4pt}}}

\newenvironment{breakenv}[3][]{\noindent\textbf{#1}#2#3.\newpar}{\bigskip}

\newtheoremstyle{numbered}{}{}{}{}{}{}{.5em}{\textbf{ #1\;#2.}\;\if\relax\detokenize{#3}\relax\else#3.\fi}

\newtheoremstyle{unnumbered}{}{}{}{}{}{}{.5em}{\textbf{#1\if\relax\detokenize{#3}\relax\else#3\fi.}\par}

\newenvironment{definition}[1][]{\noindent\textbf{Определение.\if\relax\detokenize{#1}\relax\else\;#1.\fi}\newpar}{}

\theoremstyle{numbered}
\newtheorem{property}{Свойство}[section]
\renewcommand{\theproperty}{\arabic{property}}

\newtheoremstyle{named}{}{}{}{}{}{}{0.25em}{
    \textbf{#1\if\relax\detokenize{#2}\relax.\else\;#2.\fi}
    \if\relax\detokenize{#3}\relax
    \else
        \;#3.
    \fi
}

\theoremstyle{unnumbered}
\newtheorem*{theorem*}{Теорема}

\theoremstyle{named}
\newtheorem{theorem}{Теорема}[section]
\renewcommand{\thetheorem}{\arabic{theorem}}

\theoremstyle{unnumbered}
\newtheorem*{lemma*}{Лемма}

\theoremstyle{named}
\newtheorem{lemma}{Лемма}[section]
\renewcommand{\thelemma}{\arabic{lemma}}

\theoremstyle{named}
\newtheorem*{consequence}{Следствие}

\theoremstyle{named}
\newtheorem*{note}{Замечание}

% \renewenvironment{proof}[1][]{\breakenv[Доказательство]{\if\relax\detokenize{#1}\relax\else\;\fi}{\textbf{#1}}}{

%     % \smallskip\newpar \hfill\textit{Что и требовалось доказать.}
%     \qed
% }
\renewenvironment{proof}{{\noindent\textbf{Доказательство.}}}{\qed}

\renewcommand\qedsymbol{\blacksquare}

\pagestyle{plain}
\setmainfont{PT Serif}

\titleformat{\section}
{\Large}{\textbf{\thesection.}}{0.5em}{\textbf{#1}}

\titleformat{\chapter}
{\Huge}{\textbf{\chaptername\ \thechapter.}}{0.5em}{\textbf{#1}}

\titlecontents{chapter}% <section-type>
[0pt]% <left>
{\vspace{0.5cm}}% <above-code>
{\bfseries\chaptername\ \thecontentslabel.\ }% <numbered-entry-format>
{}% <numberless-entry-format>
{\bfseries\hfill\contentspage}

\renewcommand{\cftsecfont}{\mdseries}
\renewcommand{\cftsecpagefont}{\mdseries}

\newcommand{\overbar}[1]{\mkern 1.5mu\overline{\mkern0mu#1\mkern-1.5mu}\mkern 1.5mu}

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,
    urlcolor=cyan,
    pdftitle={Ответы на билеты по математике 2021},
    pdfpagemode=FullScreen,
}

\newcommand{\plink}[2]{\hyperref[#1]{\color{blue}\underline{#2}}}

\captionsetup[figure]{labelformat=empty, labelsep=none}
\graphicspath{ {./images/} }

\title{
    Конспекты по математике \\
    \vspace{2cm} 2 семестр \\
    \vspace{2cm} ИКТ \\
    2021 — 2022
    \vfill
}
\author{
    Автор: \\
    Даниил Швалов
}
\date{}

\setlength{\cftbeforesecskip}{6pt}


\begin{document}

\begin{titlepage}
    \pagestyle{empty}
    \cleardoublepage
    \maketitle
    \thispagestyle{empty}
\end{titlepage}

\setcounter{page}{2}
{
    \setcounter{tocdepth}{4}
    \hypersetup{linkcolor=black}
    \tableofcontents
}

\chapter{Интегралы}%
\label{cha:Интегралы}

\section{Неопределенный интеграл}%
\label{sec:Неопределенный интеграл}

\subsection{Определения}%
\label{sub:Определения}

Функция \(F(x)\) — первообразная \(f(x)\), если:
\begin{gather*}
    F'(x) = f(x) \quad \text{или} \quad dF(x) = f(x) dx
\end{gather*}

Если функция \(f(x)\) имеет первообразную \(F(x)\), то она имеет \textbf{бесконечное множество первообразных}, причем все они содержатся в выражении:
\begin{gather*}
    F(x) + C, \quad C = const
\end{gather*}

\textbf{Неопределенный интеграл} функции \(f(x)\) — это совокупность всех ее первообразных:
\begin{gather*}
    \int f(x)dx = F(x) + C
\end{gather*}

\section{Свойства}%
\label{sec:Свойства}

\begin{property}
    \begin{equation}
        \Bigg(\int f(x) dx\Bigg)' = f(x)
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        \Bigg(\int f(x) dx\Bigg)' = \big(F(x) + C\big)' = F'(x) = f(x)
    \end{equation}
\end{proof}

\begin{property}
    \begin{equation}
        d\Bigg(\int f(x) dx\Bigg) = f(x)dx
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        d\Bigg(\int f(x) dx\Bigg) = d\big( F(x) + C \big) = dF(x) = f(x)dx
    \end{equation}
\end{proof}

\begin{property}
    \begin{equation}
        \int d F(x) = F(x) + C
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        \int d F(x) = \int f(x)dx = F(x) + C
    \end{equation}
\end{proof}

\begin{property}
    \begin{equation}
        \int \lambda f(x) dx = \lambda \int f(x) dx, \qquad \lambda = const
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        \begin{gathered}
            \int \lambda f(x) dx = \int \lambda F'(x) = \int d\big( \lambda F(x) \big) = \\
            = \lambda F(x) + C = \lambda \Bigg( F(x) + \frac{C}{\lambda} \Bigg) = \lambda \int f(x) dx
        \end{gathered}
    \end{equation}
\end{proof}

\begin{property}
    \begin{equation}
        \int [f(x) \pm g(x)]dx = \int f(x)dx \pm \int g(x)dx
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        \begin{gathered}
            \int [f(x) \pm g(x)]dx = \int d\big( F(x) \pm G(x) \big) = \\
            = (F(x) + C_1) \pm (G(x) + C_2) = \int f(x)dx \pm \int g(x)dx
        \end{gathered}
    \end{equation}
\end{proof}

\begin{property}
    \begin{equation}
        \begin{cases}
            \int f(x) dx = F(x) + C \\
            u = \varphi(x)
        \end{cases}
        \implies
        \int f(u) du = F(u) + C
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        dF(u) = F'(u)du = f(u)du \implies \int f(u)du = \int dF(u) = F(u) + C
    \end{equation}
\end{proof}


\subsection{Полезные тригонометрические тождества}%
\label{ssub:Тригонометрические тождества}

\begin{multicols}{2}
    \begin{enumerate}
        \item {\(\sin^{x} + \cos^2{x} = 1\)}
        \item {\(\tg{x} \cdot \ctg{x} = 1\)}
        \item {\(1 + \tg^2{x} = \dfrac{1}{\cos^2{x}} = \sec^2{x}\)}
        \item {\(1 + \ctg^2{x} = \dfrac{1}{\sin^2{x}} = \cosec^2{x}\)}
    \end{enumerate}
\end{multicols}

\subsection{Таблица основных интегралов}%
\label{sub:Таблица основных интегралов}

\begin{multicols}{2}
    \begin{enumerate}
        \item {\(\int dx = x + C\)}
        \item {\(\int x^m dx = \dfrac{x^{m + 1}}{m + 1} + C, m \neq -1\)}
        \item {\(\int \dfrac{dx}{x} = \ln|x| + C\)}
        \item {\(\int \dfrac{dx}{1 + x^2} = \arctg{x} + C\)}
        \item {\(\int \dfrac{dx}{\sqrt{1 - x^2}} = \arcsin{x} + C\)}
        \item {\(\int e^x dx = e^x + C\)}
        \item {\(\int a^x dx = \dfrac{a^x}{\ln{a}} + C\)}
        \item {\(\int \sin{x}dx = -\cos{x} + C\)}
        \item {\(\int \cos{x}dx = \sin{x} + C\)}
        \item {\(\int \sec^2{x}dx = \tg{x} + C\)}
        \item {\(\int \cosec^2{x}dx = -\ctg{x} + C\)}
        \item {\(\int \sh{x}dx = \ch{x} + C\)}
        \item {\(\int \ch{x}dx = \sh{x} + C\)}
        \item {\(\int \dfrac{dx}{\ch^2{x}} = \th{x} + C\)}
        \item {\(\int \dfrac{dx}{\sh^2{x}} = -\cth{x} + C\)}
        \item {\(\int \dfrac{f'(x)}{f(x)}dx = \ln|f(x)| + C\)}
        \item {\(\dfrac{f'(x)}{\sqrt{f(x)}}dx = 2\sqrt{f(x)} + C\)}
        \item {\(\int \dfrac{dx}{x^2 + a^2} = \dfrac{1}{a} \arctg{\dfrac{x}{a}} + C\)}
        \item {\(\int \dfrac{dx}{x^2 - a^2} = \dfrac{1}{2a} \ln {\Big|\dfrac{x - a}{x + a}\Big|} + C\)}
        \item {\(\int \dfrac{dx}{\sqrt{a^2 - x^2}} = \arcsin{\dfrac{x}{a}} + C\)}
        \item {\(\int \dfrac{dx}{\sqrt{x^2 + \lambda}} = \ln{|x + \sqrt{x^2 + \lambda}|} + C\)}
        \item {\(\int \dfrac{dx}{\sin{x}} = \ln \Big|\tg{\dfrac{x}{2}}\Big| + C\)}
        \item {\(\int \dfrac{dx}{\cos{x}} = \ln{\Big|\tg(\dfrac{x}{2} + \dfrac{\pi}{4})\Big|} + C\)}
        \item {\(\int \tg{x}dx = -\ln|\cos{x}| + C\)}
        \item {\(\int \ctg{x}dx = \ln|\sin{x}| + C\)}
    \end{enumerate}
\end{multicols}


\subsection{Замена переменной в неопределенном интеграле}%
\label{sub:Замена переменной в неопределенном интеграле}

\begin{equation}
    \lets x = \varphi(t), \varphi(t) \in C^1
    \implies
    \int f(x)dx = \int f [\varphi(t)] \cdot \varphi'(t)dt.
\end{equation}

\begin{equation}
    \lets u = \psi(x)
    \implies
    \int f[\psi(x)] \cdot \psi'(x) dx = \int f(u)du.
\end{equation}

\subsection{Интегрирование по частям}%
\label{sub:Интегрирование по частям}

\(u, v \in C^1; vdu\) — имеет первообразную. Тогда \(udv\) имеет первообразную и
\begin{equation}
    \int udv = uv - \int vdu
\end{equation}

\textbf{Целесообразность:}
\begin{itemize}
    \item {\(u\) — функция, которая упрощается при дифференцировании.}
    \item {\(dv\) — функция, интеграл которой либо известен, либо может быть найден.}
\end{itemize}

\begin{center}
    \def\arraystretch{1.7}
    \setlength{\tabcolsep}{2em}
    \begin{tabular}{|c|c|c|}
        \hline
        \textbf{Многочлен}         & \pmb{\(u\)}    & \pmb{\(dv\)}   \\
        \hline
        \(\int P(x) e^{ax} dx\)    &                & \(e^{ax} dx\)  \\
        \(\int P(x) \sin(ax)dx\)   & \(P(x)\)       & \(\sin(ax)dx\) \\
        \(\int P(x) \cos(ax)dx\)   &                & \(\cos(ax)dx\) \\
        \hline
        \(\int P(x) \ln{x}dx\)     & \(\ln{x}\)     &                \\
        \(\int P(x) \arcsin{x}dx\) & \(\arcsin{x}\) & \(P(x)dx\)     \\
        \(\int P(x) \arccos{x}dx\) & \(\arccos{x}\) &                \\
        \hline
    \end{tabular}
\end{center}

\begin{proof}
    \begin{equation}
        d\Big( uv - \int vdu \Big) = d(uv) - vdu = udv + vdu - vdu = udv
    \end{equation}
\end{proof}


\section{Интегрирование рациональных функций}%
\label{sec:Интегрирование рациональных функций}

Рациональная функция (многочлен степени \(n\)):
\begin{equation}
    P_n(x) = a_0 x^n + a_1 x^{n - 1} + \ldots + a_{n - 1} x + a_n
\end{equation}
где \(n \in \mathbb{N}\), \(a_i = const (i = 0, 1, \ldots, n)\). Корень многочлена является \(x_0: P_n(x_0) = 0\).

\begin{theorem}
    Если \(x_1\) — корень многочлена \(P(x)\), то многочлен делится без остатка на \((x - x_1)\). То есть \(P_n = R_{n - 1}(x - x_1)\), где \(R_{n - 1}\) — многочлен \((n - 1)\text{-й}\) степени.
\end{theorem}

% TODO: добавить доказательство для теоремы выше

\begin{theorem}[Основная теорема алгебры]
    Всякий многочлен \(n\text{-й}\) степени, причем \(n > 0\), имеет хотя бы один корень (\(\mathbb{R}\) или \(\mathbb{C}\)).
\end{theorem}

% TODO: добавить доказательство для теоремы выше

\begin{theorem}
    Всякий многочлен можно представить в виде:
    \[
        P_n(x) = a_0 (x - x_1) \cdot (x - x_2) \cdot \ldots \cdot (x - x_n),
    \]
\end{theorem}

% TODO: добавить доказательство для теоремы выше

\begin{theorem}
    Если два многочлена тождественно равны друг другу, то коэффициенты одного многочлена равны соответствующим коэффициентам другого многочлена:
    \begin{gather*}
        ax^3 + bx^2 + cx + d \equiv x^3 + 2x^2 + 3x + 4
        \implies
        \begin{cases}
            a = 1 \\
            b = 2 \\
            c = 3 \\
            d = 4
        \end{cases}
    \end{gather*}
\end{theorem}

% TODO: добавить доказательство для теоремы выше

\begin{theorem}
    Если \(P_n(x)\) имеет корень \(x_1 = \alpha + \beta_i\), то \(x_2 = \alpha - \beta_i\) также является корнем \(P_n(x)\).
\end{theorem}

% TODO: добавить доказательство для теоремы выше

\begin{theorem}
    % TODO: посмотреть более точную формулировку теоремы
    Всякий многочлен с действительными коэффициентами разлагается на линейные и квадратные множители с действительными коэффициентами:
    \begin{gather*}
        P_n(x) = a_0 (x - x_1)^{k_1} \cdot (x - x_2)^{k_2} \cdot \ldots \cdot (x - x_l)^{k_l} \cdot (x^2 + p_1x + q_1)^{s_1} \cdot (x^2 + p_2x + q_2)^{s2} \cdot \ldots \cdot (x^2 + p_mx + q_m)^{s_m} \\
        D = p_1 - 4q_1 < 0 forall x^2 + p_1x +q_1 \\
    \end{gather*}
    При этом \(k_1 + k2 + \ldots + k_l + (s_1 + s_2 + \ldots + s_m) \cdot 2 = n\)
\end{theorem}

% TODO: добавить доказательство для теоремы выше


\section{Дробно-рациональные функции}%
\label{sec:Дробно-рациональные функции}

Рациональная дробь (или функция):
\begin{equation}
    f(x) = \frac{P_m(x)}{Q_N(x)},
\end{equation}
где \(P_m(x)\), \(Q_n(x)\) — многочлены \(m\)-й и \(n\)-й степени соответственно. Рациональная дробь называется \textbf{правильной}, если \(n < m\), и \textbf{неправильной}, если \(n \geq m\).

Если подынтегральная дробь неправильная, нужно путем деления выделить частное и остаток от деления:
\begin{equation}
    \frac{P_n(x)}{R_m(x)} = Q_l(x) + \frac{F_s(x)}{R_m(x)},
\end{equation}
где \(Q_l(x)\) — целая часть, а \(F_s(x)\) — остаток.


Если знаменатель правильной дроби разлагается на множители \((x - a)^\alpha (x^2 + px + q)^\beta \ldots\), то справедливо следующее разложение:
\begin{gather*}
    \frac{P(x)}{(x - a)^\alpha (x^2 + px + q)^\beta \ldots} = \\
    = \frac{A_1}{x - a} + \frac{A_2}{(x - a)^2} + \ldots + \frac{A_\alpha}{(x - a)^\alpha} + \\
    + \frac{M_1x + N_1}{x^2 + px + q} + \frac{M_2x + N_2}{(x^2 + px + q)^2} + \ldots + \frac{M_\beta x + N_\beta}{(x^2 + px + q)^\beta} + \ldots
\end{gather*}

\subsection{Интегрирование дробей разных типов}%
\label{sub:Интегрирование дробей разных типов}

\subsubsection{1 тип}%
\label{ssub:1 тип}
\begin{equation}
    \int \frac{dx}{x - a} = \int \frac{d(x -a)}{x - a} = \ln |x - a| + C.
\end{equation}

\subsubsection{2 тип}%
\label{ssub:2 тип}
\begin{equation}
    \int \frac{dx}{(x - a)^n} = \int (x - a)^{-n} d(x -a) = \frac{(x - a)^{-n + 1}}{-n + a} + C
\end{equation}

\subsubsection{3 тип}%
\label{ssub:3 тип}

\begin{equation}
    I = \int \frac{Ax + B}{x^2 + bx + c}dx.
\end{equation}

\begin{equation}
    \lets u = x^2 + bx + c \implies u' = 2x + b.
\end{equation}

\begin{equation}
    Ax + B = \frac{A}{2} (2x + b) + B - \frac{bA}{2} = \frac{A}{2}u' + B - \frac{bA}{2}.
\end{equation}

\begin{equation}
    \begin{gathered}
        I = \int \frac{Ax + B}{x^2 + bx + c} =
        \frac{A}{2} \int \frac{u'}{u} dx + \Big( B - \frac{bA}{2} \Big) \int \frac{dx}{x^2 + bx + c}.
    \end{gathered}
\end{equation}

Левый интеграл в сумме равен:
\begin{equation}
    \frac{A}{2} \int \frac{u'}{u} dx = \frac{A}{2} \ln |x^2 + bx + c|.
\end{equation}

Рассмотрим правый интеграл. Его знаменатель равен
\begin{equation}
    x^2 + bx + c =
    x^2 + 2x \frac{b}{2} + \Big( \frac{b}{2} \Big)^2 + c - \Big( \frac{b}{2} \Big)^2 =
    \Big( x + \frac{b}{2} \Big)^2 +a^2,
\end{equation}

где
\begin{equation}
    a = \sqrt{c - \Big( \frac{b}{2} \Big)^2}.
\end{equation}

Мы считаем, что уравнение \(x^2 + bx + c = 0\) не имеет корней, поэтому \(c > \Big( \dfrac{b}{2} \Big)^2\).

\begin{equation}
    \lets at = x + \frac{b}{2} \implies adt = dx,
    \quad
    t = \frac{2x + b}{2a}.
\end{equation}

\begin{equation}
    x^2 + bx + c = \Big( x + \frac{b}{2} \Big)^2 + a^2 = a^2 (t^2 + 1).
\end{equation}

\begin{equation}
    \int \frac{dx}{x^2 + bx + c} =
    \frac{1}{a} \int \frac{dt}{t^2 + 1} =
    \frac{1}{a} \arctg t =
    \frac{1}{a} \arctg \frac{2x + b}{2a}.
\end{equation}

Искомый интеграл равен
\begin{equation}
    I = \frac{A}{2} \ln |x^2 + bx + c| + \Big( B - \frac{bA}{2} \Big) \frac{1}{a} \arctg \frac{2x + b}{2a} + C,
\end{equation}

где
\begin{equation}
    a = \sqrt{c - \Big( \frac{b}{2} \Big)^2}.
\end{equation}

\subsubsection{4 тип}%
\label{ssub:4 тип}

\begin{equation}
    I = \int \frac{Ax+ B}{(x^2 + bx + c)^n}dx.
\end{equation}

Выделим в числителе производную знаменателя:
\begin{equation}
    I = - \frac{A}{2(n - 1)} \frac{1}{(x^2 + bx + c)^{n - 1}} + \Big( B - \frac{bA}{2} \Big) I_n,
\end{equation}

где
\begin{equation}
    I_n = \int \frac{dx}{(x^2 + bx + c)^n}
\end{equation}

\begin{equation}
    I_1 = \int \frac{dx}{x^2 + bx + c} = \frac{1}{a} \arctg \frac{2x + b}{2a},
\end{equation}

Итоговая формула:
\begin{equation}
    (n - 1)(4c - b^2) I_n = 2(2n - 3)I_{n - 1} + \frac{2x + b}{(x^2 + bx + c)^{n - 1}}
\end{equation}

\begin{theorem}
    Любую правильную рациональную дробь \(P(x) / Q(x)\), знаменатель которой раскладывается на множители
    \begin{equation}
        \begin{gathered}
            Q(x) = (x - x_1)^{k_1} \cdot (x - x_2)^{k_2} \cdot \ldots \cdot (x - x_l)^{k_l} \cdot \\
            \cdot (x^2 + p_1x + q_1)^{s_1} \cdot (x^2 + p_2x + q_2)^{s_2} \cdot \ldots \cdot (x^2 + p_mx + q_m)^{s_m}
        \end{gathered}
    \end{equation}
    можно представить стольких простейших дробей (1-4 типа), сколько множителей в знаменателе:
    \begin{gather*}
        \frac{P(x)}{Q(x)} = \frac{A_1}{(x - x_1)^{k_1}} + \frac{A_2}{(x - x_1)^{k_1 - 1}} + \ldots + \frac{A_{k_1}}{(x - x_1)} + \ldots + \\
        + \frac{M_1x + N_1}{(x^2 + p_1x + q_1)^{s_1}} + \frac{M_2x + N_2}{(x^2 + p_1x + q_1)^{s_1 - 1}} + \ldots +  \frac{M_{s_1}x + N_{s_1}}{1}
    \end{gather*}
\end{theorem}


\begin{theorem}
    Рассмотрим линейный множитель \((x - a)^k\), входящий в разложение \(Q(x)\) при \(k \geq 1\). Тогда
    \[
        Q(x) = (x - a)^k \cdot Q_1(x),
    \]

    причем \(Q_1(x)\) не должно быть кратно \((x - a)\).

    Тогда
    \[
        \frac{P(x)}{Q(x)} = \frac{P(x)}{(x - a)^k \cdot Q_1(x)} = \frac{A}{(x - a)^k} + \frac{P_1(x)}{(x - a)^k \cdot Q_1(x)}
    \]
\end{theorem}

\begin{proof}
    Возьмем такое число \(A\), чтобы выполнялось следующее:
    \[
        P(x) - A Q_1(x) = (x - a) P_1(x)
    \]

    По теореме Безу:
    \begin{equation}
        P(x) \equiv P(a) \pmod{(x - a)}
    \end{equation}

    Если при \(x = a\) имеем \(P(a) = 0\), то \(x = a\) — корень. Так как по теореме Безу \(Q_1(a) \neq 0\), имеем:
    \begin{equation}
        A = \frac{P(a)}{Q_1(a)}
    \end{equation}

    Значит
    \[
        P_1(x) = \frac{P(x) - \frac{P(a)}{Q(a)} \cdot Q_1(x)}{(x - a)}
    \]
\end{proof}

\begin{theorem}
    Пусть многочлен \(x^2 + px + q\) входит в разложение с \(s \geq 1\) и его нельзя разложить на множители. Тогда
    \begin{equation}
        Q(x) = (x^2 + px + q)^s \cdot Q_1(x),
    \end{equation}
    где \(Q_1(x)\) не кратен \((x^2 + px + q)\). Тогда
    \begin{equation}
        \frac{P(x)}{Q(x)} = \frac{P(x)}{(x^2 + px + q)^s \cdot Q_1(x)} = \frac{Mx + N}{(x^2 + px + q)^s} + \frac{P_1(x)}{(x^2 + px + q)^{s - 1} \cdot Q_1(x)}
    \end{equation}
    Возьмем такие значения \(M, N, P_1(x)\), чтобы выполнялось следующее:
    \begin{equation}
        P(x) - (Mx + N) \cdot Q_1(x) = (x^2 + px + q) \cdot P_1(x).
    \end{equation}
    Подберем \(M\) и \(N\) так, чтобы левая часть была кратна \((x^2 + px + q)\). Пусть:
    \begin{equation}
        \begin{gathered}
            P(x) \equiv (\alpha x + \beta) \pmod{(x^2 + px + q)} \\
            Q_1(x) \equiv (\gamma x + \delta) \pmod{(x^2 + px + q)}
        \end{gathered}
    \end{equation}
    Тогда на \((x^2 + px + q)\) должно делиться выражение:
    \begin{equation}
        (\alpha x + \beta) - (Mx + N)(\gamma x + \delta) = - \gamma Mx^2 + (\alpha - M\delta - N\gamma)x + (\beta - N\delta)
    \end{equation}
\end{theorem}

\begin{theorem}
    Каждая правильная рациональная дробь \(\dfrac{P(x)}{Q(x)}\) может быть представлена в виде суммы простейших.
\end{theorem}

\begin{proof}
    Знаменатель можно представить в виде:
    \[
        Q(x) = (x - a)^k \cdot \ldots \cdot (x^2 + px + q)^s \cdot \ldots,
    \]

    где \(k, \ldots, s, \ldots \in \mathbb{N}\), причем \(Q(x)\) разлагается на множители единственным способом.

    Кроме того, для \(Q_n(x)\) должно выполняться \(\sum k + 2\sum s = n\).

    \begin{enumerate}
        \item {Если \((x - a)^k\) входит в \(Q(x)\) в \(k = 1\) (первой степени)}
        \item {
              Если \((x - a)^k\), причем \(k > 1\), то по лемме 1 выделим \(\dfrac{A_{k - 1}}{(x - a)^{k - 1}}\).
              Будем выделять до тех пор, пока не понизим степень:
              \[
                  \frac{A_1}{(x - a)} + \frac{A_2}{(x - a)^2} + \ldots + \frac{A_k}{(x - a)^k}
              \]
              }
        \item {
              Аналогично по лемме 2 квадратичному множителю \((x^2 + px + q)^s\) ставим в соответствие \(\dfrac{Mx + N}{x^2 + px +q}\) (для \(s = 1\)):
              \[
                  \frac{M_1x + N_1}{x^2 + px + q} + \frac{M_2x + N_2}{(x^2 + px + q)^2} + \ldots + \frac{M_sx + N_s}{(x^2 + px + q)^s}
              \]
              }
    \end{enumerate}
\end{proof}


\section{Интегрирование простейших иррациональных функций}%
\label{sec:Интегрирование простейших иррациональных функций}

\begin{enumerate}
    \item {
          Интегралы вида
          \[
              \int R\Big(x, (ax + b)^{m_1 / n_1}, (ax + b)^{m_2 / n_2}, \ldots, (ax + b)^{m_k / n_k}\Big) dx,
          \]
          где \(R\) — рациональная функция, а \(m_1, n_1, m_2, n_2, \ldots, m_k, n_k\) — целые числа, решаются с помощью подстановки:
          \[
              ax + b = t^s,
          \]
          где \(s\) — наименьшее общее кратное чисел \(n_1, n_2, \ldots, n_k\).
          }
    \item {
          Интегралы вида
          \[
              \int \frac{dx}{\sqrt{ax^2 + bx + c}}
          \]
          решаются выделением полного квадрата и применения \plink{sub:Таблица основных интегралов}{формул 20 или 21}.
          }
    \item {
          Интегралы вида
          \[
              \int \frac{Ax + B}{\sqrt{ax^2 + bx + c}}dx
          \]
          решаются следующим образом. Необходимо выделить в числителе производную квадратного трехчлена и представить в виде суммы:
          \begin{equation}
              \begin{gathered}
                  \int \frac{Ax + B}{\sqrt{ax^2 + bx + c}}dx =
                  \int \frac{\dfrac{A}{2a}(2ax + b) + B - \dfrac{Ab}{2a}}{\sqrt{ax^2 + bx + c}} dx = \\ \\ =
                  \frac{A}{2a} \int \frac{(2ax + b) dx}{\sqrt{ax^2 + bx + c}} + (B - \frac{Ab}{2a}) \int \frac{dx}{\sqrt{ax^2 + bx + c}}
              \end{gathered}
          \end{equation}
          }
    \item {
          Интегралы вида
          \[
              \int \frac{dx}{(x - \alpha) \sqrt{ax^2 + bx + c}}
          \]
          решаются с помощью следующей подстановки:
          \[
              x - \alpha = \frac{1}{t}.
          \]
          После этого интеграл сводится к 2 случаю.
          }
    \item {
          Интегралы вида
          \[
              \int \frac{P_n(x) dx}{\sqrt{ax^2 + bx + c}},
          \]
          где \(P_n(x)\) — полином \(n-\text{й}\) степени, решаются следующим образом:
          \[
              \int \frac{P_n(x)dx}{\sqrt{ax^2 + bx + c}} = Q_{n - 1}(x) \cdot \sqrt{ax^2 + bx + c} + \lambda \int \frac{dx}{\sqrt{ax^2 + bx + c}}.
          \]
          \(Q_{n - 1}\) — полином \((n - 1)\) степени с неопределёнными коэффициентами, \(\lambda\) — число.
          }
    \item {
          Интегралы от дифференциальных биномов вида
          \[
              \int x^m (a + bx^n)^p dx,
          \]
          где \(m\), \(n\) и \(p\) — рациональные числа.
          Три случая:
          \begin{enumerate}
              \item {
                    Если \(p\) — целое, то решением является \(x = t^s\), где \(s\) — НОК от \(m\) и \(n\).
                    }
              \item {
                    Если \((m + 1) / n\) — целое, то решением является \(a + bx^n = t^s\)
                    }
              \item {
                    \((m + 1) / n + p\) — целое, то решением является \(ax^{-n} + b = t^s\), где \(s\) — знаменатель дроби \(p\).
                    }
          \end{enumerate}
          }
\end{enumerate}

\section{Интегрирование тригонометрических функций}%
\label{sec:Интегрирование тригонометрических функций}

\subsection{Универсальная тригонометрическая подстановка}%
\label{sub:Универсальная тригонометрическая подстановка}

Интеграл вида
\begin{equation}
    \int R(\sin{x}, \cos{x})dx,
\end{equation}
где \(R\) — рациональная функция, решается с помощью универсальной тригонометрической подстановки \(\tg{(x / 2)} = t\):
\begin{equation}
    \sin{x} = \frac{2\tg{(x / 2)}}{1 + \tg^2{(x / 2)}} = \frac{2t}{1 + t^2}
    \qquad \qquad
    \cos{x} = \frac{1 - \tg^2{(x / 2)}}{1 + \tg^2{(x / 2)}} = \frac{1 - t^2}{1 + t^2}
\end{equation}
\textbf{Упрощение:}
\begin{center}
    \def\arraystretch{1.7}
    \setlength{\tabcolsep}{2em}
    \begin{tabular}{|c|c|c|}
        \hline
        \textbf{Условие}                                 & \textbf{Значение} \pmb{\(t\)} \\
        \hline
        \(R(-\sin{x}, \cos{x}) = -R(\sin{x}, \cos{x})\)  & \(t = \cos{x}\)               \\
        \hline
        \(R(\sin{x}, -\cos{x}) = -R(\sin{x}, \cos{x})\)  & \(t = \sin{x}\)               \\
        \hline
        \(R(-\sin{x}, -\cos{x}) = -R(\sin{x}, \cos{x})\) & \(t = \tg{x}\)                \\
        \hline
    \end{tabular}
\end{center}


\subsection{Понижение степени синуса и косинуса}%
\label{sub:Понижение степени синуса и косинуса}

Интеграл вида
\begin{equation}
    \int \sin^m{x} \cdot \cos^n{x}
\end{equation}
\begin{itemize}
    \item Хотя бы один из показателей степени \(m\) или \(n\) является нечетным положительным числом:
          \begin{itemize}
              \item {Если \(n\) — нечетное положительное число, то \(\sin{x} = t\)}
              \item {Если \(m\) — нечетное положительное число, то \(\cos{x} = t\)}
          \end{itemize}
    \item Оба показателя степени \(m\) и \(n\) являются четными положительными числами:
          \begin{equation}
              \sin{x}\cos{x} = \frac{1}{2} \sin{2x},
              \qquad
              \sin^2{x} = \frac{1}{2}(1 - \cos{2x}),
              \qquad
              \cos^2{x} = \frac{1}{2}(1 + \cos{2x}),
          \end{equation}
    \item Если \(m + n\) — четное отрицательное число, то \(\tg x = t\).
\end{itemize}

\subsection{Понижение степени тангенса и котангенса}%
\label{sub:Понижение степени тангенса и котангенса}

Интеграл вида
\begin{gather*}
    \int \tg^m xdx
    \qquad \qquad
    \int \ctg^m xdx,
\end{gather*}
где \(m \in \mathbb{N}\), решаются следующим образом:
\begin{equation}
    \tg^2{x} = \sec^2{x} - 1;
    \qquad \qquad
    \ctg^2{x} = \cosec^2{x} - 1.
\end{equation}
С помощью этих подстановок последовательно снижается степень \(m\).

\begin{equation}
    \int \tg^m{x} \cdot \sec^n xdx;
    \qquad \qquad
    \int \ctg^m{x} \cdot \cosec^n xdx,
\end{equation}
где \(n\) — целое положительное число.

\subsection{Использование тригонометрических преобразований}%
\label{sub:Использование тригонометрических преобразований}

Интегралы вида
\begin{equation}
    \int \sin{mx}\cos{nx}dx;
    \qquad
    \int \cos{mx}\cos{nx}dx;
    \qquad
    \int \sin{mx}\sin{nx}dx
\end{equation}
можно представить в виде суммы с помощью тригонометрических преобразований.

\subsection{Тригонометрические подстановки}%
\label{sub:Тригонометрические подстановки}

Интегралы вида
\begin{equation}
    \int R(x, \sqrt{a^2 - x^2})dx, \qquad \int R(x, \sqrt{a^2 + x^2})dx, \qquad \int R(x, \sqrt{x^2 - a^2})dx
\end{equation}
приводятся к интегралам от рациональной относительно \(\sin{t}\) и \(\cos{t}\) функции с помощью тригонометрической подстановки соответственно:
\begin{enumerate}
    \item \(x = a\sin{t}\) или \(x = a\cos{t}\);
    \item \(x = a\tg{t}\) или \(x = a\ctg t\);
    \item \(x = a\sec{t}\) или \(x = a\cosec{t}\).
\end{enumerate}


\chapter{Определенный интеграл}%
\label{cha:Определенный интеграл}

\section{Определение}%
\label{sec:Определение}

\(\lets f: [a, b] \to R\). Разделим \([a, b]\) на \(n\) частей точками \(a = x_0 < x_1 < \ldots < x_{n - 1} < x_n = b\), выберем на каждом элементарном отрезке \([x_{k - 1}, x_k]\) произвольную точку \(\xi_k\) и найдем длину каждого такого отрезка: \(\Delta x_k = x_k - x_{k - 1}\). Тогда \textbf{интегральной суммой} для функции \(f(x)\) на \([a, b]\) называется сумма вида \(\sigma = \displaystyle \sum_{k=1}^n f(\xi_k) \Delta x_k\), причем эта сумма имеет конечный придел \(I\), если:
\[
    \forall \varepsilon > 0 \exists \delta > 0: \max{\Delta x_k} < \delta \implies |\sigma - I| < \varepsilon
\]

Определенным интегралом от функции \(f(x)\) на \([a, b]\) называется предел интегральной суммы при условии, что длина наибольшего из элементарных отрезков (\(\max{\Delta x_k}\)) стремится к нулю:
\[
    I = \int_a^b f(x) dx = \lim_{\max{\Delta x_k} \to 0}{\sigma} = \lim_{\max{\Delta x_k} \to 0}{\displaystyle \sum_{k=1}^n f(\xi_k) \Delta x_k}.
\]

Числа \(a\) и \(b\) называются \textbf{нижним} и \textbf{верхним пределами интегрирования} соответственно.


\section{Свойства}%
\label{sec:Свойства}


\begin{property}
    \begin{equation}
        \int\limits_a^b \lambda f(x)dx = \lambda \cdot \int\limits_a^b f(x) dx,
        \quad
        \lambda = const.
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        \int\limits_a^b \lambda f(x)dx =
        \lim_{\Delta x \to 0}{\sum_{i=1}^n \lambda f(\varepsilon_i) \Delta x_i} =
        \lambda \lim_{\Delta x \to 0}{\sum_{i=1}^n f(\varepsilon_i) \Delta x_i} = \lambda  \int\limits_a^b f(x)dx.
    \end{equation}
\end{proof}

\begin{property}
    \begin{equation}
        \int\limits_{a}^{b} [f(x) + g(x)] dx =
        \int\limits_{a}^{b} f(x)dx + \int\limits_{a}^{b} g(x)dx.
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        \begin{gathered}
            \int\limits_{a}^{b} [f(x) + g(x)] =
            \lim_{\Delta x \to 0} \sum_{i = 1}^n [f(c_i) + g(c_i)] \Delta x_i = \\ =
            \lim_{\Delta x \to 0} \sum_{i = 1}^n f(c_i) \Delta x_i + \lim_{\Delta x \to 0} \sum_{i = 1}^n g(c_i) \Delta x_i =
            \int\limits_{a}^{b} f(x)dx + \int\limits_{a}^{b} g(x)dx.
        \end{gathered}
    \end{equation}
\end{proof}

\begin{property}
    \begin{equation}
        a < b \; \forall x \in [a, b]: f(x) \leq g(x) \implies \int\limits_a^b f(x)dx \leq \int\limits_a^b g(x)dx
    \end{equation}
\end{property}

\begin{proof}
    \begin{gather*}
        \int\limits_a^b g(x)dx - \int\limits_a^b f(x)dx = \int\limits_a^b (g(x) - f(x))dx \\
        g(x) - f(x) \geq 0 \implies \int\limits_a^b (g(x) - f(x))dx \geq 0 \implies \int\limits_a^b g(x)dx - \int\limits_a^b f(x)dx \geq 0
    \end{gather*}
\end{proof}

\begin{property}
    Пусть \(m\) — наименьшее значение, \(M\) — наибольшее значение, \(y = f(x)\) непрерывна на \([a, b], a \leq b\). Тогда
    \begin{equation}
        m(b - a) \leq \int\limits_a^b f(x)dx \leq M(b - a)
    \end{equation}
\end{property}

\begin{proof}
    По условию, \(m \leq f(x) \leq M\). Тогда по 3-му свойству: % TODO: добавить ссылку
    \begin{equation}
        \begin{gathered}
            \int\limits_a^b mdx \leq \int\limits_a^b f(x)dx \leq \int\limits_a^b Mdx,
            \quad
            \int\limits_a^b mdx = m(b - a),
            \quad
            \int\limits_a^b Mdx = M(b - a)
            \implies \\ \implies
            m(b - a) \leq \int\limits_a^b f(x)dx \leq M(b - a)
        \end{gathered}
    \end{equation}
\end{proof}

\begin{property}
    \begin{equation}
        \lets b \in [a, c]
        \implies
        \int\limits_{a}^{c} f(x)dx = \int\limits_{a}^{b} f(x)dx + \int\limits_{b}^{c} f(x)dx.
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        \begin{gathered}
            \int\limits_{a}^{c} f(x)dx =
            \lim_{\Delta x \to 0} \sum_{i = 1}^n \underset{[a, c]}{f(w_i) \Delta x_i} =
            \lim_{\Delta x \to 0} \Big( \sum_{i = 1}^k \underset{[a, b]}{f(w_i) \Delta x_i} + \sum_{i = k +1}^n \underset{[b, c]}{f(w_i) \Delta x_i} \Big) = \\ =
            \lim_{\Delta x \to 0} \sum_{i = 1}^k \underset{[a, b]}{f(w_i) \Delta x_i} +
            \lim_{\Delta x \to 0} \sum_{i = k +1}^n \underset{[b, c]}{f(w_i) \Delta x_i} =
            \int\limits_{a}^{b} f(x)dx + \int\limits_{b}^{c} f(x)dx.
        \end{gathered}
    \end{equation}
\end{proof}

\section{Теоремы}%
\label{sec:Теоремы}

\begin{theorem}[о среднем]
    Пусть \(y = f(x)\) непрерывна на \([a, b]\), тогда:
    \[
        \exists \xi \in [a, b]: \int_a^b f(x)dx = f(\xi)(b - a)
    \]
\end{theorem}

\begin{proof}
    Пусть \(m\) — наименьшее значение, \(M\) — наибольшее значение \(y = f(x)\) на \([a, b]\). Тогда по 4-му свойству: % TODO: добавить ссылку
    \[
        m \leq \frac{1}{b - a} \int_b^a f(x)dx \leq M
    \]

    Пусть \(m \leq x_0 \mu M\), поскольку \(y = f(x)\) непрерывна на \([a, b]\), то она принимает промежуточные все значения от \(m\) до \(M\). Значит
    \[
        \exists \xi \in [a, b]: f(\xi) = \mu
    \]
\end{proof}




\begin{theorem}
    Если \(y = f(x)\) непрерывна на \([a, b]\), то \(\exists \displaystyle \int_a^b f(x)dx\).
\end{theorem}

\begin{proof}
    % TODO: добавить доказательство для теоремы выше
\end{proof}

\begin{note}
    Интеграл не зависит от переменной интегрирования:
    \[
        \int_a^b f(x)dx = \int_a^b f(z)dz = \int_a^b f(t)dt
    \]
\end{note}

\begin{definition}
    \(\displaystyle F(x) = \int_a^x f(t)dt\) — функция верхнего порядка
\end{definition}

\begin{theorem}
    \[
        F'(x) = f(x)
    \]
\end{theorem}

\begin{proof}
    \begin{gather*}
        \Delta F(x) = F(x + \Delta x) - F(x) = \int_a^{x + \Delta x} f(t)dt - \int_a^x f(t)dt = \\
        = \int_a^x f(t)dt + f_x^{x + \Delta x} f(t)dt - \int_a^x f(t)dt = f_x^{x + \Delta x} f(t)dt
    \end{gather*}

    По теореме о среднем: % TODO: добавить ссылку
    \begin{gather*}
        \Delta F(x) = \int_x^{x + \Delta x}f(x)dt = f(\xi)(x + \Delta x - x) \\
        \Delta F(x) = f(\xi)\Delta x \\
        \xi \in [x, x + \Delta x] \\
        F'(x) = \lim_{\Delta x \to 0}{\frac{\Delta F(x)}{\Delta x}} = \lim_{\Delta x \to 0}{f(\xi)} = f(\xi)
    \end{gather*}

    Так как \(y = f(x)\) непрерывна, то при \(\Delta x \to 0 \; \xi \to x\).
\end{proof}

% TODO: может переместить в другой раздел?
\begin{theorem}[Теорема Барроу]
    Производная интеграла с переменным верхним пределом по этому верхнему пределу равна значению подынтегральной функции на верхнем пределе интегрирования:
    \begin{equation}
        \Phi'(x) = \Big( \int\limits_{a}^{x} f(t)dt \Big)'_x = f(x).
    \end{equation}
\end{theorem}

\begin{proof}
    \begin{equation}
        \Phi(x + \Delta x) =
        \int\limits_{a}^{x + \Delta x} f(t)dt =
        \int\limits_{a}^{x} f(t)dt + \int\limits_{x}^{x + \Delta x} f(t)dt =
        \Phi(x) + \int\limits_{x}^{\Delta x} f(t)dt
    \end{equation}

    \begin{equation}
        \Delta \Phi = \Phi(x + \Delta x) - \Phi(x) =
        \int\limits_{x}^{x + \Delta x} f(t)dt = f(c) \Delta x,
        \quad
        c \in [x, x + \Delta x].
    \end{equation}

    \begin{equation}
        f(c) = \frac{\Delta \Phi}{\Delta x}.
    \end{equation}

    Точка \(c\) существует по теореме о среднем. Пусть \(\Delta x \to 0\), тогда \(c \to x\). Так как \(f(t)\) непрерывна в точке \(t = x\), то
    \begin{equation}
        \exists \lim_{\Delta x \to 0} f(c) = f(x)
        \implies
        \Phi'(x) = \lim_{\Delta x \to 0} \frac{\Delta \Phi}{\Delta x} = f(x).
    \end{equation}
\end{proof}

\begin{consequence}
    Интеграл \(\int\limits_{a}^{x} f(t)dt\) с переменным верхним пределом интегрирования есть первообразная для подынтегральной функции \(f(x)\). Из этого следует, что любая непрерывная функция имеет первообразную:
    \begin{equation}
        \Phi(x) = \int\limits_{a}^{x} f(t)dt.
    \end{equation}
\end{consequence}
% TODO: end

% TODO: может переместить в другой раздел?
\begin{theorem}[Формула Ньютона-Лейбница]
    \begin{equation}
        \lets f(x) \in C[a, b], \; F'(x) = f(x)
        \implies
        \int\limits_a^b f(x)dx = F(b) - F(a)
    \end{equation}
\end{theorem}

\begin{proof}
    \begin{equation}
        \lets \Phi(x) = \int\limits_a^x f(t)dt, \; x \in [a, b].
    \end{equation}
    \begin{equation}
        F'(x) = \Phi'(x) = f(x) \implies \int\limits_a^x f(t)dt = F(x) + C.
    \end{equation}
    \begin{equation}
        \lets x = a \implies 0 = F(a) + C \implies C = -F(a).
    \end{equation}
    \begin{equation}
        \lets x = b \implies = F(b) + C = F(b) - F(a).
    \end{equation}
\end{proof}
% TODO: end

\subsection{Замена переменной}%
\label{sub:Замена переменной}

\begin{gather*}
    \begin{cases}
        \int_a^b f(x)dx \\
        x = g(t)        \\
        dx = g'(t)dt    \\
        a = g(\alpha)   \\
        b = g(\beta)
    \end{cases}
    \implies
    \int_a^b f(x)dx = \int_\alpha^\beta f(g(t)) g'(t)dt
\end{gather*}

Пример:
\begin{gather*}
    \begin{cases}
        \int_0^{16} \sqrt{256 - x^2}dx               \\
        x = 16\sin{t}                                \\
        dx = 16\cos{t}dt                             \\
        \sqrt{16^2 - 16^2\sin^2{t}} = 16\cos{t}      \\
        x = 0 \implies t = \arcsin{\frac{x}{16}} = 0 \\
        x = 16 \implies t = \arcsin{1} = \frac{\pi}{2}
    \end{cases}
    \implies
    \int_0^{16} \sqrt{256 - x^2}dx = \int_0^{\frac{\pi}{2}} 16\cos{t} \cdot 16\cos{t}dt = \\
    = 168 \int_0^{\frac{\pi}{2}} (1 + \cos{2t})dt = 128(t + \frac{\sin{2t}}{2}) |_0^{\frac{\pi}{2}} = \\
    = 128(\frac{\pi}{2} + \frac{\sin{\pi}}{2}) - 128(0 + \frac{\sin{0}}{2}) = 64\pi
\end{gather*}

\section{Вычисление площади плоской фигуры}%
\label{sec:Вычисление площади плоской фигуры}

Площадь криволинейной трапеции, ограниченной кривой \(y = f(x)\), где \(f(x) \geq 0\), прямыми \(x = a\), \(x = b\) и отрезком \([a, b]\) оси \(OX\), вычисляется по формуле:
\[
    S = \int_a^b f(x)dx
\]

Площадь фигуры, ограниченной кривыми \(y = f_1(x)\) и \(y = f_2(x)\), где \(f_1(x) \leq f_2(x)\), прямыми \(x = a\), \(x = b\), вычисляется по формуле:
\[
    S = \int_a^b [f_2(x) - f_1(x)]dx
\]

Если кривая задана параметрически, то есть \(x = x(t)\), \(y = y(t)\), то площадь криволинейной трапеции, ограниченной этой кривой, прямыми \(x = a\), \(x = b\) и отрезком \([a, b]\) оси \(OX\), вычисляется по формуле:
\[
    \int_{t_1}^{t_2} y(t) x'(t) dt,
\]

где \(t_1\) и \(t_2\) находится из следующих уравнений:
\begin{gather*}
    a = x(t_1) \\
    b = x(t_2)
\end{gather*}

причем \(y(t) \geq 0\) при \(t_1 \leq t \leq t_2\).

Площадь кривой сектора, ограниченного прямой в полярных координатах, заданной \(\rho = \rho(\theta)\) и двумя полярными радиусами \(\theta = \alpha\), \(\theta = \beta\) (\(\alpha < \beta\)), вычисляется по формуле:
\[
    S = \frac{1}{2} \int_{\alpha}^{\beta} \rho^2 d\theta
\]

\section{Вычисление длины дуги плоской кривой}%
\label{sec:Вычисление длины дуги плоской кривой}

Если кривая \(y = f(x)\) на \([a, b]\) — гладкая (т. е. \(y' = f'(x)\) непрерывна), то длина дуги равна:
\[
    L = \int_a^b \sqrt{1 + y^2} dx
\]

Если кривая задана параметрически \(x = x(t)\), \(y = y(t)\), где \(x(t)\) и \(y(t)\) — непрерывно диф. функции, то длина дуги равна:
\[
    L = \int_{t_1}^{t_2} \sqrt{x'^2 + y'^2}dt, \quad t_1 \leq t \leq t_2
\]

Если кривая задана в полярных координатах \(\rho = \rho(\theta)\), где \(\alpha \leq \theta \leq \beta\), то длина дуги равна:
\[
    L = \int_{\alpha}^{\beta} \sqrt{\rho^2 + \rho'^2} d\theta
\]

Циклоида:
\begin{gather*}
    x = a(t - \sin{t}),
    \qquad
    y = a(1 - \cos{t})
\end{gather*}

% TODO: добавить длину дуги

Кардиоида:
\begin{gather*}
    \rho = a(1 + \cos{\varphi})
\end{gather*}

\begin{gather*}
    L = 2 \int_0^\pi \sqrt{a^2(1 + \cos{\varphi})^2 + a^2\sin^2{\varphi}} d\varphi = 4a \int_0^\pi \cos{\dfrac{\varphi}{2}} d\varphi
\end{gather*}

\section{Вычисление площади поверхности вращения}%
\label{sec:Вычисление площади поверхности вращения}

Площадь поверхности вращения вокруг оси \(OX\):
\begin{gather*}
    S_x = 2\pi \int_a^b y\sqrt{1 + (y')^2}dx
\end{gather*}

Площадь боковой поверхности усеченного конуса:
\begin{gather*}
    S = \pi(r + R)l
\end{gather*}

Пусть \(S = S(x)\) — величина площади поверхности части фигуры вращения, лежащей левее плоскости \(x = a\), то есть \(S(a) = 0\), \(S(b) = S\).

\(S\) получит приращение:
\[
    \Delta S = \pi \Big(y + (y + dy)\Big) \cdot dl = 2\pi ydl + \pi dy \cdot dl
\]

Поскольку \(\pi dy \cdot dl\) при \(\Delta x \to 0\) — бесконечно малая более высокого порядка, чем \(dl\), значит ее можно отбросить.

Тогда получим:
\begin{equation}
    dS = 2\pi ydl, dl = \sqrt{1 + (y')^2}dx
    \implies
    S = 2\pi \int_a^b y\sqrt{1 + (y')^2}dx
\end{equation}

\begin{equation}
    \lets x = x(t), y = y(t) \implies S = 2\pi \int_{t_1}^{t_2} y\sqrt{(x'_t)^2 + (y'_t)^2}dt
\end{equation}


\section{Вычисление объема тела}%
\label{sec:Вычисление объема тела}

\subsection{По известным площадям поперечных сечений}%
\label{sub:По известным площадям поперечных сечений}

Если площадь сечения тела плоскости, перпендикулярного оси \(OX\), может быть выражена как функция от \(x\), то есть \(S = f(x)\) при \(a \leq x \leq b\), то объем части тела, заключенной между перпендикулярной оси \(OX\) плоскостями \(x = a\) и \(x = b\), вычисляется по формуле:
\[
    V = \int_a^b S(x) dx
\]

\subsection{Объем тела вращения}%
\label{sub:Объем тела вращения}

Если криволинейная трапеция, ограниченная кривой \(y = f(x)\) и прямыми \(y = 0\), \(x = a\), \(x = b\), вращается вокруг оси \(OX\), то объем тела вращения равен:
\[
    V_x = \pi \int_a^b y^2 dx
\]

Если фигура, ограниченная кривыми \(y_1 = f_1(x)\), \(y_2 = f_2(x)\), где \(0 \leq f_1(x) \leq f_2(x)\), прямыми \(x = a\), \(x = b\), вращается вокруг оси \(OX\), то объем вычисляется по формуле:
\[
    V_x = \pi \int_a^b (y_2^2 - y_1^2)dx
\]


\chapter{Несобственные интегралы}%
\label{cha:Несобственные интегралы}

\section{Несобственный интеграл 1-го рода}%
\label{sec:Несобственный интеграл 1-го рода}

\begin{equation}
    \lets f(x) \in C [a, +\infty),
    \quad
    \int\limits_{a}^{+\infty} f(x)dx = \lim_{b \to +\infty} \int\limits_{a}^{b} f(x)dx
\end{equation}

Если этот предел существует и конечен, то несобственный интеграл называется \textbf{сходящимся}, если же предел не существует или равен бесконечности, — \textbf{расходящимся}.


Если для функции \(f(x)\) верно
\begin{equation}
    \begin{dcases*}
        f(x) \in C [a, c) \cup (c, b] \\
        \begin{sqcases}
            \lim_{x \to c - 0}{f(x)} = \infty \\
            \lim_{x \to c + 0}{f(x)} = \infty
        \end{sqcases}
    \end{dcases*}
\end{equation}

Тогда:
\begin{equation}
    \int_a^b f(x)dx = \lim_{\alpha \to 0}{\displaystyle \int_a^{c - \alpha}f(x)dx} + \lim_{\beta \to 0}{\int_{c + \beta}^b f(x)dx}
\end{equation}

Такой несобственный интеграл называется \textbf{сходящимся}, если оба предела в правой части равны, и расходящиеся, если не существует хотя бы один из них.

% TODO: добавить свойства

\subsection{Теоремы}%
\label{sub:Теоремы}


\begin{theorem}[Первый признак сравнения]
    Пусть \(f(x)\) и \(g(x)\) — непрерывны на \([a, +\infty)\), причем \(\forall x \in [a, +\infty) \implies 0 \leq f(x) \leq g(x)\). Тогда:
    \begin{itemize}
        \item {Если \(\int_a^{+\infty}f(x)dx\) расходится, то \(\int_a^{+\infty}g(x)dx\) тоже расходится.}
        \item {Если \(\int_a^{+\infty}g(x)dx\) сходится, то \(\int_a^{+\infty}f(x)dx\) тоже сходится.}
    \end{itemize}

    Причем:
    \[
        \forall x \in [a, +\infty) \implies \int_a^{+\infty} f(x)dx \; \leq \; \int_a^{+\infty} g(x)dx
    \]
\end{theorem}

\begin{proof}
    % TODO: добавить доказательство
\end{proof}

\begin{theorem}[Предельный признак сравнения]
    \newpar
    Если выполняется следующее:
    \begin{gather*}
        \begin{cases}
            \displaystyle \exists \lim_{x \to \infty}{\frac{f(x)}{g(x)}} = k: \quad 0 < k < +\infty \\
            f(x) > 0                                                                                \\
            g(x) > 0
        \end{cases}
    \end{gather*}

    Тогда оба \(\int_a^{+\infty} f(x)dx\) и \(\int_a^{+\infty} g(x)dx\) сходятся (или расходятся) одновременно.
\end{theorem}

\begin{proof}
    % TODO: добавить доказательство
\end{proof}

\begin{theorem}
    Если \(\int_a^{+\infty} |f(x)|dx\) сходится, то сходится и \(\int_a^{+\infty} f(x)dx\).
\end{theorem}

\begin{proof}
    % TODO: добавить доказательство
\end{proof}

\begin{theorem}
    Если при \(x \to +\infty\) функция \(f(x) \geq 0\) является бесконечно малой порядка \(p > 0\) по сравнению с \(1 / x\), то интеграл \(\displaystyle \int_a^{+\infty}f(x)dx\) сходится при \(p > 1\) и расходится при \(p \leq 1\).

    Если функция \(f(x) \geq 0\) определена и непрерывна на \(x \in [a, b]\) и является бесконечно большой порядка \(p\) по сравнению с \(1 / (b - x)\) при \(x \to b - 0\), то \(\displaystyle \int_a^b f(x)dx\)  сходится при \(p < 1\) и расходится при \(p \geq 1\).
\end{theorem}

\section{Несобственный интеграл второго рода}%
\label{sec:Несобственный интеграл второго рода}

\begin{equation}
    \begin{gathered}
        \lets \int_a^d f(x)dx, a\leq c \leq d
        \implies
        \begin{dcases*}
            \int_a^c f(x)dx = \lim_{b \to c - 0}{\int_a^b f(x)dx} \\
            \int_c^d f(x)dx = \lim_{a \to c + 0}{\int_a^d f(x)dx}
        \end{dcases*}
        \implies \\
        \implies
        \int_a^d f(x)dx = \int_a^c f(x)dx + \int_c^d f(x)dx
    \end{gathered}
\end{equation}

Интеграл сходится, если \(\exists \lim\) и он конечен.

\begin{theorem}[Предельный признак сравнения]
    Пусть \(f(x)\) и \(g(x)\) непрерывны на \([a, b)\), причем в точке \(x = b\) они терпят бесконечный разрыв. Тогда, если
    \begin{gather*}
        \exists \lim_{x \to b}{\frac{f(x)}{g(x)}} = k: \quad 0 < k < \infty
    \end{gather*}

    То оба \(\int_a^b f(x)dx\) и \(\int_a^b g(x)dx\) сходятся (или расходятся) одновременно.
\end{theorem}

\begin{theorem}
    Если \(f(x)\) знакопеременная функция на \([a, c]\), имеющая разрыв только в точке \(c\), причем \(\int_a^c |f(x)| dx\) сходится, то и \(\int_a^c f(x) dx\) сходится
\end{theorem}


\section{Признаки сходимости несобственных интегралов}%
\label{sec:Признаки сходимости несобственных интегралов}

\subsection{Первый признак сравнения}%
\label{sub:Первый признак сравнения}

% FIX: remove
% \subsubsection{Для несобственных интегралов 1 рода}%
% \label{ssub:Для несобственных интегралов 1 рода}

\begin{equation}
    \lets f(x), g(x) \in C [a, +\infty): \forall x \in [a, +\infty) \implies 0 \leq f(x) \leq g(x).
\end{equation}

\begin{equation}
    \int\limits_{a}^{+\infty} f(x)dx \; — \; \text{расходится} \implies \int\limits_{a}^{+\infty} g(x)dx \; — \; \text{тоже расходится}.
\end{equation}

\begin{equation}
    \int\limits_{a}^{+\infty} g(x)dx \; — \; \text{сходится} \implies \int\limits_{a}^{+\infty} f(x)dx \; — \; \text{тоже сходится}.
\end{equation}

\begin{proof}
    \begin{equation}
        \lets F(M) = \int\limits_{a}^{M} f(x)dx,
        \quad
        G(M) = \int\limits_{a}^{M} g(x)dx,
        \quad
        M \geq a.
    \end{equation}

    Из условия следует, что
    \begin{equation}
        \forall M \geq a \implies F(M) \leq G(M).
    \end{equation}

    Если интеграл \(\int\limits_{a}^{+ \infty} g(x)dx\) сходится, то функция \(G\) ограничена на \([a, +\infty)\). Значит ограничена и функция \(F\). Следовательно, интеграл \(\int\limits_{a}^{+\infty} f(x)dx\) сходится.
\end{proof}

\subsection{Второй признак сравнения}%
\label{sub:Второй признак сравнения}

\begin{equation}
    \lets f(x), g(x) \in C [a, +\infty): f(x) \geq 0, g(x) \geq 0.
\end{equation}
\begin{equation}
    \exists \lim_{x \to +\infty} \frac{f(x)}{g(x)} = k: 0 < k < \infty,
\end{equation}
значит интегралы \(\int\limits_{a}^{+\infty} f(x)dx\) и \(\int\limits_{a}^{+\infty} g(x)dx\)  сходятся или расходятся одновременно.

\begin{proof}
    \begin{equation}
        \forall \varepsilon > 0 \; \exists \delta = \delta(\varepsilon): \forall x > \delta \implies \Big| \frac{f(x)}{g(x)} - A \Big| < \varepsilon
        \implies
        K - \varepsilon < \frac{f(x)}{g(x)} < K + \varepsilon.
    \end{equation}
    \begin{equation}
        (K - \varepsilon) g(x) < f(x) < (K + \varepsilon) f(x).
    \end{equation}

    \begin{itemize}
        \item Если \(\int\limits_{a}^{+\infty} f(x)dx\) сходится, то по первому признаку сходится \(\int\limits_{a}^{+\infty} (K - \varepsilon) g(x)dx\), а следовательно сходится \(\int\limits_{a}^{+\infty} g(x)dx\).
        \item Если \(\int\limits_{a}^{+\infty} g(x)dx\) сходится, то сходится \(\int\limits_{a}^{+\infty} (K + \varepsilon) g(x)dx\), следовательно, по первому признаку сходится \(\int\limits_{a}^{+\infty} f(x)dx\).
        \item Пусть \(\int\limits_{a}^{+\infty} f(x)dx\) расходится. Если \(\int\limits_{a}^{+\infty} g(x)dx\) сходится, то по первому признаку \(\int\limits_{a}^{+\infty} f(x)dx\) сходится — противоречие.
        \item Пусть \(\int\limits_{a}^{+\infty} g(x)dx\) расходится. Если интеграл \(\int\limits_{a}^{+\infty} f(x)dx\) сходится, то по первому признаку \(\int\limits_{a}^{+\infty} g(x)dx\) сходится — противоречие.
    \end{itemize}
\end{proof}


\chapter{Функции двух переменных}%
\label{cha:Функции двух переменных}

\section{Определения}%
\label{sec:Определения}

\begin{siderules}
    Пусть даны непустые множества \(D\) и \(U\). Если каждой паре действительных чисел \((x, y)\), принадлежащей множеству \(D\), по определенному правилу ставится в соответствие один и только один элемент \(u\) из \(U\), то говорят, что на множестве \(D\) задана функция \(f\) (или отображение \(f\)) с множеством значений \(U\).
\end{siderules}

Обозначения:
\begin{gather*}
    D \overset{f} \rightarrow U; \qquad f: D \rightarrow U; \qquad u = f(x, y)
\end{gather*}

% TODO: геометрический смысл

Пусть дана функция \(z = f(x, y)\). Тогда:
\begin{itemize}
    \item {\(D(f)\) — область определения.}
    \item {\(E(f)\) — множество значений функции.}
    \item {Линия, ограничивающая \(D(f)\) — граница определения.}
    \item {Точки \((x, y)\), не лежащие на границе — внутренние.}
    \item {Область, состоящая только из внутренних точек — открытая.}
    \item {Область, состоящая из внутренних точек и границы — замкнутая.}
    \item {Линия уровня — геометрическое место точек \((x, y)\) плоскости, в которых функция принимает одно и то же значение.}
\end{itemize}


\subsection{Предел}%
\label{sub:Предел}
\begin{gather*}
    \lim_{\substack{x \to x_0 \\ y \to y_0}}{f(x, y)} = \lim_{M \to M_0}{f(M)} = A \\
    \iff \\
    \Big[ \forall \varepsilon > 0 \; \exists \delta: \forall M(x, y): 0 < \sqrt{(x - x_0)^2 + (y - y_0)^2} < \delta \implies |f(M) - A| < \varepsilon \Big]
\end{gather*}

\subsection{Непрерывность}%
\label{sub:Непрерывность}

Функция \(z = f(x, y)\) непрерывна в точке \(M_0(x_0, y_0)\), если:
\begin{enumerate}
    \item {\(z = f(x, y)\) определена в точке \(M_0\) и в ее окрестности}
    \item {\(\exists \displaystyle \lim_{M \to M_0}{f(M)}\)}
    \item {\(\displaystyle \lim_{M \to M_0}{f(M)} = f(M_0)\)}
\end{enumerate}

\subsection{Ограниченность}%
\label{sub:Ограниченность}
\begin{siderules}
    Область называется ограниченной, если все ее точки принадлежат кругу радиуса \(R\). В противном случае область не ограничена.
\end{siderules}

\begin{theorem}
    Пусть \(z = f(x, y)\) непрерывна в ограниченной замкнутой области (непрерывна в каждой точке области). Тогда функция:
    \begin{enumerate}
        \item {
              Ограничена в этой области, то есть:
              \begin{gather*}
                  \exists R > 0 : \forall (x, y) \implies |f(x, y)| < R.
              \end{gather*}
              }
        \item {
              Имеет точки, в которых принимает наибольшее \(M\) и наименьшее \(m\) значение.
              }
        \item {
              Принимает хотя бы в одной точке области промежуточное значение между \(m\) и \(M\).
              }
    \end{enumerate}
\end{theorem}

%TODO: добавить доказательство

\subsection{Частные производные}%
\label{sub:Частные производные}

\begin{siderules}
    Частной производной от функции \(u = f(x, y)\) по независимой переменной \(x\) называется конечный предел вида:
    \begin{gather*}
        \lim_{\Delta x \to 0}{\frac{f(x + \Delta x, y) - f(x, y)}{\Delta x}} = \frac{\partial z}{\partial x} = f'_x (x, y)
    \end{gather*}

    Частной производной по \(y\) называется конечный предел:
    \begin{gather*}
        \lim_{\Delta y \to 0}{\frac{f(x, y + \Delta y) - f(x, y)}{\Delta y}} = \frac{\partial z}{\partial y} = f'_y (x, y)
    \end{gather*}

    Для частных производных справедливы обычные правила и формулы дифференцирования.
\end{siderules}

Обозначения:
\begin{gather*}
    \frac{\partial z}{\partial x} = \frac{\partial f}{\partial x} = z'_x = f'_x = \lim_{\Delta x \to 0}{\dfrac{\Delta_x z}{\Delta x}}
\end{gather*}

Частное приращение
\begin{gather*}
    \Delta_x z = f(x + \Delta x, y) - f(x, y)
\end{gather*}

Геометрический смысл производной \(z'_x\):
\begin{itemize}
    \item {\(f'_x(x_0, y_0) = \tg{\alpha}\).}
    \item {\(\alpha\) — угол наклона касательной к кривой \(z = f(x, y_0)\) к оси \(OX\).}
\end{itemize}


\subsection{Частный дифференциал}%
\label{sub:Частный дифференциал}

\begin{gather*}
    d_x z = \frac{\partial z}{\partial x} \Delta x \\
    d_y = z = \frac{\partial z}{\partial x} \Delta y
\end{gather*}

\begin{gather*}
    \begin{cases}
        d_x z = \frac{\partial z}{\partial x} dx \\
        d_y = z = \frac{\partial z}{\partial x} dy
    \end{cases}
    \implies
    \begin{cases}
        \frac{\partial z}{\partial x} = \frac{d_x z}{dx} \\
        \frac{\partial z}{\partial y} = \frac{d_y z}{dy}
    \end{cases}
\end{gather*}

Полное приращение:
\begin{gather*}
    \Delta z = f(x + \Delta x, y + \Delta y) - f(x, y)
\end{gather*}

\begin{theorem}
    Если в точке \(M_0(x_0, y_0, z_0)\) и ее окрестности \(\exists \dfrac{\partial z}{\partial x}, \dfrac{\partial z}{\partial y}\) и непрерывны, то
    \begin{gather*}
        \Delta z = f'_x(x_0, y_0) \Delta x + f'_y(x_0, y_0) \Delta y + \alpha \Delta x + \beta \Delta y \\
        \alpha = \alpha(\Delta x, \Delta y) \to 0 \\
        \beta = \beta(\Delta x, \Delta y) \to 0 \\
        \text{где} \\
        \Delta x \to 0 \\
        \Delta y \to 0
    \end{gather*}
\end{theorem}

\begin{proof}
    \begin{gather*}
        \Delta z =
        \underbrace{f(x_0 + \Delta x, y_0 + \Delta y) - f(x_0, y_0 + \Delta y)}_{\substack{\text{частное приращение функции} \\ \text{одной переменной \(x_0\)}}}
        +
        \underbrace{f(x_0, y_0 + \Delta y) - f(x_0, y)}_{\substack{\text{частное приращение функции} \\ \text{одной переменной \(y_0\)}}}
    \end{gather*}

    По формуле конечных приращений, получим:
    \begin{gather*}
        \Delta z = f'_x(x_0 + \theta_1 \Delta x, y_0 + \Delta y) \Delta x + f'_y(x_0, y_0 + \theta_2 \Delta y) \Delta y
    \end{gather*}

    По теореме Лагранжа:
    \begin{gather*}
        \frac{f(b) - f(a)}{b - a} = f'(c)
    \end{gather*}

    Обозначим:
    \begin{gather*}
        f'_x(x_0 + \theta_1 \Delta x, y_0 + \Delta y) = f'_x(x_0, y_0)
        f'_y(x_0, y_0 + \theta_2 \Delta y) = f'_y(x_0, y_0)
    \end{gather*}

    Получим:
    \begin{gather*}
        \Delta z = f'_x(x_0, y_0) \Delta x + f'_y(x_0, y_0) \Delta y + \alpha \Delta x + \beta \Delta y.
    \end{gather*}
\end{proof}

\begin{note}
    По теореме из существования и непрерывности \(\dfrac{\partial z}{\partial x} \Big|_{M_0}\) и \(\dfrac{\partial z}{\partial y} \Big|_{M_0}\) вытекает непрерывность самой функции \(z = f(x, y)\) в точке \(M_0\).
\end{note}

\begin{definition}
    Функция \(z = f(x, y)\) называется дифференцируемой в точке \(M(x_0, y_0)\), если ее можно представить в виде:
    \begin{gather*}
        \Delta z = \underbrace{f'_x(x_0, y_0) \Delta x + f'_y(x_0, y_0)}_\text{полное приращение} \Delta y + \alpha \Delta x + \beta \Delta y \\
        \alpha = \alpha(\Delta x, \Delta y) \to 0 \\
        \beta = \beta(\Delta x, \Delta y) \to 0 \\
        \text{где} \\
        \Delta x \to 0 \\
        \Delta y \to 0
    \end{gather*}

    Полное приращение представляется в виде дифференциала:
    \begin{gather*}
        dz = \frac{\partial z}{\partial x} dx + \frac{\partial z}{\partial y} dy
    \end{gather*}
\end{definition}

\section{Инвариантность формы полного дифференциала}%
\label{sec:Инвариантность формы полного дифференциала}

\begin{gather*}
    z = f(x, y) \\
    dz = \frac{\partial z}{\partial x} dx + \frac{\partial z}{\partial y} dy \\
    x = x(u, v) \\
    y = y(u, v) \\
    z = f(x(u, v), y(u, v)) = F(u, v) \\
    dz = \frac{\partial F}{\partial u} du + \frac{\partial F}{\partial v} dv =
    \Big( \frac{\partial z}{\partial x} \cdot \frac{\partial x}{\partial u} + \frac{\partial z}{\partial y} \cdot \frac{\partial y}{\partial u} \Big) du + \Big( \frac{\partial z}{\partial x} \cdot \frac{\partial x}{\partial v} + \frac{\partial z}{\partial y} \cdot \frac{\partial y}{\partial v} \Big) dv = \\
    \frac{\partial z}{\partial x} \Big( \frac{\partial x}{\partial u}du + \frac{\partial x}{\partial v}dv \Big) + \frac{\partial z}{\partial y} \Big( \frac{\partial y}{\partial u}du + \frac{\Delta y}{\Delta v}dv \Big) =
    \frac{\Delta z}{\Delta x} dx + \frac{\Delta z}{\Delta y} dy
\end{gather*}

Функция \(z = f(x, y)\) задана неявно: \(F(x, y, z) = 0\).
\begin{gather*}
    \frac{\partial F}{\partial x} = \frac{\partial F}{\partial x} + \frac{\partial F}{\partial z} \cdot \frac{\partial z}{\partial x} = 0 \implies \frac{\partial z}{\partial x} = - \frac{\frac{\partial F}{\partial x}}{\frac{\partial F}{\partial z}} \\
    \frac{\partial F}{\partial y} = \frac{\partial F}{\partial y} + \frac{\partial F}{\partial z} \cdot \frac{\partial z}{\partial y} = 0 \implies \frac{\partial z}{\partial y} = - \frac{\frac{\partial F}{\partial y}}{\frac{\partial F}{\partial z}}
\end{gather*}

Касательная к плоскости неявно заданной функции:
\begin{gather*}
    F'_x(x_0, y_0, z_0)(x - x_0) + F'_y(x_0, y_0, z_0)(y - y_0) + F'_z(x_0, y_0, z_0)(z - z_0) = 0
\end{gather*}

Нормаль:
\begin{gather*}
    \frac{x - x_0}{F'_x(M_0)} = \frac{y - y_0}{F'_y(M_0)} = \frac{z - z_0}{F'_z(M_0)}
\end{gather*}

\section{Производная по направлению}%
\label{sec:Производная по направлению}

\(f(M)\) — частные производные по направлению \((OX)\) выражает скорость изменения функции в направлении координатных осей.

\begin{gather*}
    \overrightarrow{M_0 M} = \overrightarrow{l} \\
    \frac{\partial f(M_0)}{\partial l} = \lim_{M \to M_0}{\dfrac{f(M) - f(M_0)}{M_0M}}
\end{gather*}

Пусть функция \(f(x, y, z)\) имеет непрерывные частные производные в \(D\). Тогда:
\begin{gather*}
    \frac{\partial f(M_0)}{\partial l} = \frac{\partial f}{\partial x} \cos{\alpha} + \frac{\partial f}{\partial y} \cos{\beta} + \frac{\partial f}{\partial z} \cos{\gamma}
\end{gather*}

Пусть \(M_0M = t\), тогда:
\begin{gather*}
    x - x_0 = t\cos{\alpha} \\
    y - y_0 = t\cos{\beta} \\
    z - z_0 = t\cos{\gamma} \\
    f(x, y, z) = \varphi(t)
\end{gather*}

Получим, что:
\begin{gather*}
    \varphi'(t) = \frac{\partial f}{\partial x} \cdot \frac{dx}{dt} + \frac{\partial f}{\partial y} \cdot \frac{dy}{dt} + \frac{\partial f}{\partial z} \cdot \frac{dz}{dt}
\end{gather*}

Пусть в точке \(M_0\) \(t = 0\), тогда:
\begin{gather*}
    \frac{\partial f(M_0)}{\partial l} = \lim_{M \to M_0}{\dfrac{f(M) - f(M_0)}{M_0M}} = \lim_{t \to 0}{\dfrac{\varphi(t) - \varphi(0)}{t}} = \varphi'(0)
\end{gather*}

Обозначим:
\begin{gather*}
    \frac{dx}{dt} = \cos{\alpha} \\
    \frac{dy}{dt} = \cos{\beta} \\
    \frac{dz}{dt} = \cos{\gamma}
\end{gather*}

Получим:
\begin{gather*}
    \frac{\partial f(M_0)}{\partial l} = \frac{\partial f}{\partial x} \cos{\alpha} + \frac{\partial f}{\partial y} \cos{\beta} + \frac{\partial f}{\partial z} \cos{\gamma}
\end{gather*}

По какому направлению функция в данной точке будет расти быстрее?

\begin{gather*}
    a\cos{\alpha} + b\cos{\beta} + c\cos{\gamma} = \\
    = \sqrt{a^2 + b^2 + c^2} \Big( \frac{a}{\sqrt{a^2 + b^2 + c^2}} \cos{\alpha} + \frac{b}{\sqrt{a^2 + b^2 + c^2}} \cos{\beta} + \frac{c}{\sqrt{a^2 + b^2 + c^2}} \cos{\gamma} \Big)
\end{gather*}

Пусть:
\begin{gather*}
    a = \frac{\partial f(M_0)}{\partial x} \\
    b = \frac{\partial f(M_0)}{\partial y} \\
    c = \frac{\partial f(M_0)}{\partial z}
\end{gather*}

Тогда получим вектор градиент:
\begin{gather*}
    \overrightarrow{g} \Big( \frac{\partial f(M_0)}{\partial x}, \frac{\partial f(M_0)}{\partial y}, \frac{\partial f(M_0)}{\partial z} \Big) = grad z \Big|_{M_0} \\
    \frac{\partial f}{\partial l} = \sqrt{a^2 + b^2 + c^2} \cos{\angle(\overrightarrow{g}, \overrightarrow{l})} \\
    \frac{\partial f}{\partial l} = |grad z| \cos{\angle(grad z, l)}
\end{gather*}

\section{Однородные функции}%
\label{sec:Однородные функции}

\begin{siderules}
    Однородным многочленом называется многочлен, состоящий из членов одного и того же измерения. Например, однородный многочлен третьей степени:
    \begin{gather*}
        2x^3 + 3x^2y + y^2x - 7y^3
    \end{gather*}
\end{siderules}

\begin{siderules}
    Функция \(z = f(x, y)\) называется однородной функцией \(n\)-й степени, если:
    \begin{gather*}
        f(xt, yt) = t^n \cdot f(x, y)
    \end{gather*}

    Пример однородной функции второй степени:
    \begin{gather*}
        f(x, y) = x \cdot \frac{\sqrt{x^4 + y^4}}{x - y} \cdot \ln{\frac{x}{y}}
    \end{gather*}
\end{siderules}

\begin{theorem}[Формула Эйлера]
    Пусть функция \(f(x, y)\) имеет непрерывные частные производные в области \(D\) и
    \begin{gather*}
        \forall t > 0 \implies f(x_0t, y_0t) = t^n f(x_0, y_0) \Big| \frac{\partial}{\partial t} \\
        f'_x(x_0t, y_0t) \cdot x_0 + f'_x(x_0t, y_0t) \cdot y_0 = n t^{n - 1} \cdot f(x_0, y_0) \\
        % TODO: добавить значок пусть
        t = 1: \qquad \qquad f'_x(x_0y, y_0) \cdot x_0 + f'_y(x_0, y_0) \cdot y_0 = n \cdot f(x_0, y_0) \\
    \end{gather*}

    Формула Эйлера:
    \begin{gather*}
        f'_x(x, y) \cdot x + f'_y(x, y) \cdot y = n \cdot f(x, y).
    \end{gather*}

    Справедливо и обратное утверждение.
\end{theorem}

\section{Вторая частная производная}%
\label{sec:Вторая частная производная}

\begin{gather*}
    % TODO: вторая производная по одной переменной
    \frac{\partial}{\partial x} \Big(\frac{\partial z}{\partial x}\Big) = \frac{\partial^2 z}{\partial x^2} = z''_{xx} = (z'_x)'_x \\
    % TODO: это смешанные производные
    \frac{\partial}{\partial y} \Big(\frac{\partial z}{\partial x}\Big) = \frac{\partial^2 z}{\partial x \partial y} = z''_{xy} = (z'_x)'_y \\
\end{gather*}

\begin{theorem}[Теорема Шварца]
    Пусть \(z = f(x, y)\) определена в открытой области \(D\). Пусть в \(D \exists f'_x, f'_y\) и \(f''_{xy}, f''_{yx}\), причем \(f''_{xy}, f''_{yx}\) непрерывны в точке \(M_0(x_0, y_0) \in D\). Тогда в точке \(M_0 \implies f''_{xy}(x_0, y_0) = f''_{yx}(x_0, y_0)\).
\end{theorem}

\begin{proof}
    Рассмотрим следующее выражение:
    \begin{gather*}
        W = \frac{f(x_0 + h, y_0 + k) - f(x_0 + h, y_0) - f(x_0, y_0 + k) + f(x_0, y_0)}{h \cdot k},
    \end{gather*}

    где \(h, k \neq 0\) и малы настолько, что прямоугольник % TODO: см. 25 минуту лекции
    \(\in D\).

    Введем вспомогательную функцию:
    \begin{gather*}
        \varphi(x) = \frac{f(x, y_0 + k) - f(x, y_0)}{k},
    \end{gather*}

    которая в \([x_0, x_0 + h]\) имеет непрерывную производную:
    \begin{gather*}
        \varphi'(x) = \frac{f'_x(x, y_0 + k) - f'_x(x, y_0)}{k}.
    \end{gather*}

    Тогда
    \begin{gather*}
        W = \frac{1}{h} \Big( \frac{f(x_0 + h, y_0 + k) - f(x_0 + h, y_0)}{k} - \frac{f(x_0, y_0 + k) - f(x_0, y_0)}{k} \Big) \\
        W = \frac{\varphi(x_0 + h) - \varphi(x_0)}{h}
    \end{gather*}

    По теореме Лагранжа:
    \begin{gather*}
        \exists 0 < \theta < 1: W = \varphi'(x_0 + \theta h) = \frac{f'_x(x_0 + \theta h, y_0 + k) - f'_x(x_0 + \theta h, y_0)}{k}.
    \end{gather*}

    Применим теорему Лагранжа к \(f'_x(x_0 + \theta h, y)\) в \([y_0, y_0 + k]\):
    \begin{gather*}
        \exists 0 < \theta_1 < 1: W = f''_{xy}(x_0 \theta h, y_0 + \theta_1 k).
    \end{gather*}

    Аналогично:
    \begin{gather*}
        \psi (y) = \frac{f(x_0 + h, y) - f(x_0, y)}{h} \\
        W = f''_{yx}(x_0 + \theta_2 h, y_0 + \theta_3 k)
    \end{gather*}
\end{proof}

\section{Дифференциалы высших порядков}%
\label{sec:Дифференциалы высших порядков}

\begin{gather*}
    d^2 z = d(dz) =
    d\Big( \frac{\partial z}{\partial x}dx + \frac{\partial z}{\partial y}dy \Big) =
    \Big( \frac{\partial z}{\partial x}dx + \frac{\partial z}{\partial y}dy \Big)'_x dx + \Big( \frac{\partial z}{\partial x}dx + \frac{\partial z}{\partial y}dy \Big)'_y dy = \\
    =\Big( \frac{\partial^2 z}{\partial x^2}dx + \frac{\partial^2 z}{\partial x \partial y}dy \Big) + \Big( \frac{\partial^2 z}{\partial x \partial y}dx + \frac{\partial^2 z}{\partial y^2} \Big)dy =
    \frac{\partial^2 z}{\partial x^2}dx^2 + 2 \frac{\partial^2 z}{\partial x \partial y}dx \cdot dy + \frac{\partial^2 z}{\partial y^2} dy^2 \\
    d^n z = d(d^{n - 1} z) = \Big( \frac{\partial}{\partial x}dx + \frac{\partial}{\partial y} dy \Big)^n, n \in \mathbb{N} \\
\end{gather*}

\subsection{Экстремумы}%
\label{sub:Экстремумы}

% TODO: добавить


\section{Производная функции двух переменных}%
\label{sec:Производная функции двух переменных}

\subsection{Полный дифференциал}%
\label{sub:Полный дифференциал}

Полным приращением функции \(z = f(x, y)\) в т. \(M(x, y)\) называется разность
\begin{equation}
    \Delta z = f(x + \Delta x, y + \Delta y) - f(x, y),
\end{equation}

где \(\Delta x\) и \(\Delta y\) — произвольное приращение аргументов.

Функция \(z = f(x, y)\) называется дифференцируемой в т. \((x, y)\), если в этой точке полное приращение можно представить в виде:
\begin{equation}
    \Delta z = A \cdot \Delta x + B \cdot \Delta y + o(\rho),
\end{equation}

где \(\rho = \sqrt{\Delta x^2 + \Delta y^2}\).

Полным дифференциалом называется функции \(z = f(x, y)\) называется главная часть полного приращения \(\Delta z\), линейная относительно приращений аргументов \(\Delta x\) и \(\Delta y\):
\begin{equation}
    dz = A \cdot \Delta x + B \cdot \Delta y.
\end{equation}

Дифференциалы независимых переменных совпадают с их приращениями:
\begin{equation}
    dx = \Delta x \qquad \qquad dy = \Delta y.
\end{equation}

\section{Дифференциалы}%
\label{sec:Дифференциалы}

Полный дифференциал функции \(z = f(x, y)\) вычисляется по формуле:
\begin{equation}
    dz = \frac{\partial z}{\partial x}dx + \frac{\partial z}{\partial y}dy
\end{equation}

Полный дифференциал функции трех аргументов \(u = f(x, y, z)\) вычисляется по формуле:
\begin{equation}
    du = \frac{\partial u}{\partial x}dx + \frac{\partial u}{\partial y}dy + \frac{\partial u}{\partial z}dz
\end{equation}

При достаточно малом \(\rho = \sqrt{\Delta x^2 + \Delta y^2}\) для дифференцируемой функции \(z = f(x, y)\) справедливо:
\begin{gather}
    \Delta z \approx dz \\
    f(x + \Delta x, y + \Delta y) \approx f(x, y) + dz
\end{gather}

\section{Частные производные, дифференциалы высших порядков}%
\label{sec:Частные производные, дифференциалы высших порядков}

Частными производными \(n\)-го порядка от функции \(z = f(x, y)\) называется частная производная от ее частных производных \(n - 1\) первого порядка:
\begin{gather*}
    \frac{\partial}{\partial x} \Big(\frac{\partial z}{\partial x}\Big) = \frac{\partial^2 z}{\partial x^2} = f''_{xx}(x, y)
    \qquad \qquad
    \frac{\partial}{\partial y} \Big(\frac{\partial z}{\partial x}\Big) = \frac{\partial^2 z}{\partial x \partial y} = f''_{xy}(x, y) \\
    \frac{\partial}{\partial x} \Big(\frac{\partial z}{\partial y}\Big) = \frac{\partial^2 z}{\partial y \partial x} = f''_{yx}(x, y)
    \qquad \qquad
    \frac{\partial}{\partial y} \Big(\frac{\partial z}{\partial y}\Big) = \frac{\partial^2 z}{\partial y^2} = f''_{yy}(x, y) \\
    \frac{\partial}{\partial x} \Big(\frac{\partial^2 z}{\partial x^2}\Big) = \frac{\partial^3 z}{\partial x^3} = f'''_{xxx}(x, y)
    \qquad \qquad
    \frac{\partial}{\partial y} \Big(\frac{\partial^2 z}{\partial x^2}\Big) = \frac{\partial^3 z}{\partial x^2 \partial y} = f'''_{xxy}(x, y).
\end{gather*}

Смешанные производные, отличающиеся друг от друга только последовательностью дифференцирования, равны между собой, если они непрерывны. Например:
\begin{gather*}
    \frac{\partial^2 z}{\partial x \partial y} = \frac{\partial^2 z}{\partial y \partial x}
\end{gather*}

Дифференциал \(n\)-го порядка — дифференциал от полного дифференциала \(n - 1\) порядка:
\begin{gather*}
    d^2 z = d(dz),
    \qquad \qquad
    d^3 z = d(d^2z),
    \qquad \qquad
    d^n z = d(d^{n - 1} z).
\end{gather*}

Если \(x\), \(y\) — независимые переменные и функция \(f(x, y)\) имеет непрерывные частные производные, то дифференциалы высших порядков вычисляются по формуле:
\begin{gather*}
    d^2 z = \frac{\partial^2 z}{\partial x^2}dx^2 + 2\frac{\partial^2 z}{\partial x \partial y}dxdy + \frac{\partial^2 z}{\partial y^2}dy^2 \\
    d^3 z = \frac{\partial^3 z}{\partial x^3}dx^3 + 3\frac{\partial^3 z}{\partial x^2 \partial y}dx^2 dy + 3\frac{\partial^3 z}{\partial x \partial y^2}dxdy^2 + \frac{\partial^3 z}{\partial y^3}dy^3 \\
    d^n z = \Big( \frac{\partial}{\partial x}dx + \frac{\partial}{\partial y}dy \Big)^n z \; \text{\small (символическая запись)}
\end{gather*}

\section{Дифференцирование сложных функции}%
\label{sec:Дифференцирование сложных функции}

\begin{equation}
    \lets z = f(x, y), f(x, y) \in C^1, x = x(t), y = y(t)
    \implies
    \frac{dz}{dt} = \frac{\partial z}{\partial x} \cdot \frac{dx}{dt} + \frac{\partial z}{\partial y} \cdot \frac{dy}{dt}
\end{equation}

\begin{equation}
    \lets z = f(x, y), f(x, y) \in C^1, y = \varphi(x)
    \implies
    \frac{dz}{dx} = \frac{\partial z}{\partial x} + \frac{\partial z}{\partial y} \cdot \frac{dy}{dx}
\end{equation}

\begin{equation}
    \lets z = f(x, y), f(x, y) \in C^1, x = x(u, v), y = y(u, v)
    \implies
    \begin{dcases*}
        \frac{\partial z}{\partial u} = \frac{\partial z}{\partial x} \cdot \frac{\partial x}{\partial u} + \frac{\partial z}{\partial y} \cdot \frac{\partial y}{\partial u}
        \\
        \frac{\partial z}{\partial v} = \frac{\partial z}{\partial x} \cdot \frac{\partial x}{\partial v} + \frac{\partial z}{\partial y} \cdot \frac{\partial y}{\partial v}
    \end{dcases*}
\end{equation}


\section{Производные по направлению. Градиент}%
\label{sec:Производные по направлению. Градиент}

Производной функции \(z = f(x, y)\) в точке \(M(x, y)\) в направлении вектора \(l = \vv{MM_1}\) называется предел:
\begin{gather*}
    \frac{\partial z}{\partial l} = \lim_{|\vv{MM_1}| \to 0}{\frac{f(M_1) - f(M)}{|\vv{MM_1}|}} = \lim_{\rho \to 0}{\frac{\Delta z}{\rho}},
    \qquad
    \rho = \sqrt{\Delta x^2 + \Delta y^2}
\end{gather*}

\begin{equation}
    \lets z = f(x, y), f(x, y) \in C^1
    \implies
    \frac{\partial z}{\partial l} = \frac{\partial z}{\partial x} \cdot \cos{\alpha} + \frac{\partial z}{\partial y} \cdot \sin{\alpha},
    \quad
    \alpha = \angle (\vv{l}, Ox)
\end{equation}

\begin{equation}
    \begin{gathered}
        \lets u = f(x, y, z), f(x, y, z) \in C^1
        \implies
        \frac{\partial u}{\partial l} = \frac{\partial u}{\partial x} \cos{\alpha} + \frac{\partial u}{\partial y} \cos{\beta} + \frac{\partial u}{\partial z} \cos{\gamma},
        \\
        \cos{\alpha} = \frac{l_x}{|\vv{l}|},
        \quad
        \cos{\beta} = \frac{l_y}{|\vv{l}|},
        \quad
        \cos{\gamma} = \frac{l_z}{|\vv{l}|}.
    \end{gathered}
\end{equation}


Градиентом функции \(z = f(x, y)\) в точке \(M(x, y)\) называется вектор с началом в точке \(M\), имеющий своими координатами частные производные функции \(z\):
\begin{equation}
    grad \; z = \frac{\partial z}{\partial x} \vv{i} + \frac{\partial z}{\partial y} \vv{j}
\end{equation}
Градиент указывает направление наибыстрейшего роста функции в точке.

Связь градиента и производной в направлении:
\begin{equation}
    \frac{\partial z}{\partial l} = \text{пр}_l grad \; z
\end{equation}

\begin{equation}
    \Big(\frac{\partial z}{\partial l}\Big)_\text{наиб} = |grad \; z| = \sqrt{\Big(\frac{\partial z}{\partial x}\Big)^2 + \Big(\frac{\partial z}{\partial y}\Big)^2}.
\end{equation}

\begin{equation}
    \lets u = f(x, y, z)
    \implies
    grad \; u = \frac{\partial u}{\partial x}\vv{i} + \frac{\partial u}{\partial y}\vv{j} + \frac{\partial u}{\partial z}\vv{k}
\end{equation}

\section{Дифференцирование неявных функций}%
\label{sec:Дифференцирование неявных функций}

Производная неявной функции \(y = y(x)\), заданной с помощью уравнения \(F(x, y) = 0\), где \(F(x, y)\) — дифференцируемая функция по \(x\) и \(y\), вычисляется по формуле:
\begin{gather*}
    y' = -\frac{\partial F / \partial x}{\partial F / \partial y} \qquad \qquad \frac{\partial F}{\partial y} \neq 0
\end{gather*}

Производные высших порядков неявной функции находятся последовательным дифференцированием, рассматривая при это \(y\) как функцию от \(x\).

Частные производные неявной функции \(z = \varphi(x, y)\), заданной уравнением \(F(x, y, z) = 0\), где \(F(x, y, z)\) — дифференцируемая функция по \(x\), \(y\), \(z\), вычисляется по формуле:
\begin{gather*}
    \frac{\partial z}{\partial x} = -\frac{\partial F / \partial x}{\partial F / \partial z}
    \qquad \qquad
    \frac{\partial z}{\partial y} = -\frac{\partial F / \partial y}{\partial F / \partial z}
    \qquad \qquad
    \frac{\partial F}{\partial z} \neq 0
\end{gather*}

\section{Свойства двукратного интеграла}%
\label{sec:Свойства двукратного интеграла}

\begin{siderules}
    Если правильную в направлении \((Oy)\) область \(D\) разбить на \(D_1\) и \(D_2\) линией \(|| (Oy)\), то \(I_D = I_{D_1} + I_{D_2}\)
\end{siderules}

\begin{proof}
    Пусть \(x = C\) (\(a < c < b\)). Тогда
    \begin{equation}
        \begin{gathered}
            I_D = \int_a^b \Big( \int_{\varphi_1(x)}^{\varphi_2(x)} f(x, y)dy \Big)dx = \int_a^b \Phi(x)dx = \\ =
            \int_a^c \Phi(x)dx + \int_c^b \Phi(x)dx =
            \ldots =
            I_{D_1} + I_{D_2}.
        \end{gathered}
    \end{equation}
\end{proof}

Следствие:
\begin{siderules}
    \begin{equation}
        I_D = I_{D_1} + I_{D_2} + \ldots + I_{D_N}.
    \end{equation}
\end{siderules}

Оценка двукратного интеграла:
\begin{siderules}
    Пусть \(m\) — наим., \(M\) — наиб. значения \(z = f(x, y)\) в обл. \(D\). \(S\) — площадь обл. \(D\). Тогда:
    \begin{equation}
        mS \leq \int_a^b \Big( \int_{\varphi_1(x)}^{\varphi_2(x)} f(x, y)dy \Big)dx \leq MS
    \end{equation}
\end{siderules}

\begin{proof}
    \begin{gather}
        \Phi(x) = \int_{\varphi_1(x)}^{\varphi_2(x)} f(x, y)dy \geq \int_{\varphi_1(x)}^{\varphi_2(x)} mdy = m \Big|_{\varphi_1(x)}^{\varphi_2(x)} = m\big( \varphi_2(x) - \varphi_1(x) \big) \\
        I_D = \int_a^b \Phi(x)dx \geq \int_a^b m\big( \varphi_2(x) - \varphi_1(x) \big)dx = mS.
    \end{gather}

    Аналогично получим, что \(I_D \leq MS\). Отсюда:
    \begin{equation}
        mS \leq I_D \leq MS.
    \end{equation}
\end{proof}

Теорема о среднем
\begin{siderules}
    \(z = f(x, y)\) — непр. в обл. \(D\). В некоторой т. \(P\) обл. \(D\) \(z = f(x, y)\) принимает значение \(f(P) = \frac{1}{S} I_D \implies I_D = f(P) \cdot S\).
\end{siderules}

4-я теорема
\begin{siderules}
    \begin{equation}
        \iint\limits_D f(x, y)dxdy = \int_a^b \Big( \int_{\varphi_1(x)}^{\varphi_2(x)} f(x, y)dy \Big)dx
    \end{equation}
    \(z = f(x, y)\) — непр. в обл. \(D\).
\end{siderules}

\begin{proof}
    Разобьем обл. \(D\) прямыми, \(||\) осям координат на \(n\) правильных областей: \(\Delta S_1, \Delta S_2, \ldots, \Delta S_n\).
    \begin{equation}
        I_D = I_{\Delta S_1} + I_{\Delta S_2} + \ldots + I_{\Delta S_n} \text{(свойство 1)}.
    \end{equation}

    Каждое слагаемое
    \begin{equation}
        I_{\Delta S_i} = f(P_i) \cdot \Delta S_i \text{(свойство 3)}.
    \end{equation}

    Тогда
    \begin{equation}
        I_D = \sum_{i=1}^n f(P_i) \cdot \Delta S_i = \iint\limits_D f(x, y)dxdy.
    \end{equation}
\end{proof}

Геометрический смысл
Пусть \(z = f(x, y) \geq 0\). Тогда если тело ограничено:
\begin{itemize}
    \item {\(z = f(x, y)\) — сверху}
    \item {\(z = 0\) (плоскость \(XOY\)) — снизу цилиндрической поверхностью}
    \item {\(y = \varphi_1(x)\), \(y = \varphi_2(x)\), образующие которой параллельны \((OZ)\)}
\end{itemize}

\begin{equation}
    V = \iint\limits_D f(x, y)dxdy.
\end{equation}

\section{Касательная плоскость и нормаль к поверхности}%
\label{sec:Касательная плоскость и нормаль к поверхности}

Касательная плоскость к поверхности в точке \(M\) — плоскость, проходящая через точку \(M\) этой поверхности, если угол между этой плоскостью и секущей, проходящей через точку \(M\) и любую точку \(M_1\) поверхности стремится к нулю, когда \(M_1\) стремится к \(M\).

Касательная плоскость к поверхности в точке \(M\) содержит касательные ко всем кривым, проведенным на поверхности через точку \(M\).

Нормаль к поверхности в точке \(M\) — прямая, проходящая через т. \(M\), перпендикулярная касательной плоскости в этой точке.

Если поверхность задана уравнением \(F(x, y, z) = 0\) и в т. \(M(x_0, y_0, z_0)\) частные производные \(\frac{\partial F}{\partial x}\), \(\frac{\partial F}{\partial y}\) и \(\frac{\partial F}{\partial z}\) конечны и не равны 0, то уравнение касательной плоскости к поверхности в т. \(M(x_0, y_0, z_0)\) задается в виде:
\begin{equation}
    \Big(\frac{\partial F}{\partial x}\Big)_M (x - x_0) +  \Big(\frac{\partial F}{\partial y}\Big)_M (y - y_0) + \Big(\frac{\partial F}{\partial z}\Big)_M (z - z_0) = 0
\end{equation}
а уравнение нормали к поверхности в этой точке задается в виде:
\begin{equation}
    \frac{x - x_0}{\Big(\frac{\partial F}{\partial x}\Big)_M} = \frac{y - y_0}{\Big(\frac{\partial F}{\partial y}\Big)_M} = \frac{z - z_0}{\Big(\frac{\partial F}{\partial z}\Big)_M}
\end{equation}

Если уравнение поверхности задано явным образом, т. е. \(z = f(x, y)\), где частная производная \(\Big(\frac{\partial z}{\partial x}\Big)_M\) и \(\Big(\frac{\partial z}{\partial y}\Big)_M\) в т. \(M(x_0, y_0, z_0)\) конечны (и могут быть равны 0), то уравнение касательной плоскости в т. \(M\) задается в виде:
\begin{equation}
    z - z_0 = \Big(\frac{\partial z}{\partial x}\Big)_M (x - x_0) + \Big(\frac{\partial z}{\partial y}\Big)_M (y - y_0)
\end{equation}
у равнение нормали к поверхности в этой точке задается в виде:
\begin{equation}
    \frac{x - x_0}{\Big(\frac{\partial z}{\partial x}\Big)_M} = \frac{y - y_0}{\Big(\frac{\partial z}{\partial y}\Big)_M} = \frac{z - z_0}{-1}
\end{equation}

Равенство нулю, например, \(\Big(\frac{\partial z}{\partial x}\Big)_M = 0\), означает, что касательная плоскость параллельна оси \(Ox\), а нормаль лежит в плоскости \(x = x_0\).

\section{Дифференцирование функций двух независимых переменных}%
\label{sec:Дифференцирование функций двух независимых переменных}

\subsection{Экстремум}%
\label{sub:Экстремум}

Функция \(z = f(x, y)\) имеет максимум (минимум) в т. \(M_0(x_0, y_0)\), если значение функции в этой точке больше (меньше), чем ее значение в любой другой точке \(M(x, y)\) в некоторой окрестности т. \(M_0\):
\begin{equation}
    \forall M(x, y): \exists \delta >0: |M_0 M| < \delta \implies f(x_0, y_0) > f(x, y)
\end{equation}

Максимум или минимум функции называется ее экстремумом. Точка \(M_1\) в которой функция имеет экстремум называется \textbf{\textit{точкой экстремума}}.

Необходимое условие экстремума
Если дифференцируемая функция \(z = f(x, y)\) достигает экстремума в т. \(M_0(x_0, y_0)\), то ее частная производная первого порядка в этой точке равна нулю:
\begin{equation}
    \frac{\partial f(x_0, y_0)}{\partial x} = 0, \quad \frac{\partial f(x_0, y_0)}{\partial y} = 0.
\end{equation}

Точки, в которых производная равна нулю, называются \textbf{\textit{стационарными точками}}.

\subsubsection{Достаточное условие наличия или отсутствия экстремума}%
\label{ssub:Достаточное условие наличия или отсутствия экстремума}

Пусть \(M_0(x_0, y_0)\) — стационарная точка функции \(z = f(x, y)\). Введем обозначения:
\begin{equation}
    A = \frac{\partial^2 f(x_0, y_0)}{\partial x^2}; \quad B = \frac{\partial^2 f(x_0, y_0)}{\partial x \partial y}; \quad C = \frac{\partial^2 f(x_0, y_0)}{\partial y^2} \quad \Delta = AC - B^2.
\end{equation}

\begin{enumerate}
    \item {
          Если \(\Delta > 0\), то функция имеет в т. \(M_0\) экстремум
          \begin{itemize}
              \item {максимум при \(A < 0\) (или \(C < 0\))}
              \item {минимум при \(A > 0\) (или \(C > 0\))}
          \end{itemize}
          }
    \item {Если \(\Delta < 0\), то в т. \(M_0\) экстремума нет.}
    \item {Если \(\Delta = 0\), то необходимо дальнейшее исследование.}
\end{enumerate}

\section{Условный экстремум. Наибольшее и наименьшее значение функции в замкнутой области}%
\label{sec:Условный экстремум. Наибольшее и наименьшее значение функции в замкнутой области}

Условный экстремум функции \(z = f(x, y)\) — это экстремум этой функции, достигнутый при условии, что переменные \(x\) и \(y\) связаны уравнениями:
\begin{equation}
    \varphi(x, y) = 0 \text{(уравнение связи)}
\end{equation}
Нахождение условного экстремума сводится к отношению обычного экстремума к функции Лагранжа:
\begin{equation}
    u = f(x, y) + \lambda \varphi(x, y),
\end{equation}
где \(\lambda\) — постоянная, неравная 0.

Необходимое условие функции Лагранжа
\begin{equation}
    \begin{dcases*}
        \frac{\partial u}{\partial x} = \frac{\partial z}{\partial x} + \lambda \frac{\partial \varphi}{\partial x} = 0 \\
        \frac{\partial u}{\partial y} = \frac{\partial z}{\partial y} + \lambda \frac{\partial \varphi}{\partial y} = 0 \\
        \varphi(x, y) = 0
    \end{dcases*}
\end{equation}
Из этой системы находим \(x, y\) и \(\lambda\).

Для того, чтобы найти наиб. или наим. значение функции требуется:
\begin{enumerate}
    \item Найти критические точки функции \(z = f(x, y)\), принадлежащие области \(D\).
    \item Вычислить значения функции в критических точках.
    \item Исследовать поведение функции \(z = f(x, y)\) на границе области \(D\), найдя точки возможного наибольшего и наименьшего значений. Вычислить значения функции в полученных точках.
    \item Из значений функции, полученных в предыдущих двух пунктах, выбрать наибольшее и наименьшее.
\end{enumerate}

% TODO: дописать


\chapter{Тройной интеграл}
\label{cha:Тройной интеграл}

\(\lets\) задана область \(V\) в пространстве, ограниченной поверхностью \(G\). \(\lets\) в области \(V\) и на ее границе \(G\) определена \(u = f(x, y, z)\) (если \(u \geq 0\), то \(u\) можно считать плотностью распределения некоторого вещества в \(V\)). Разобъем \(V\) произвольным образом на ячейки \(\Delta v_i\) \((V_i = \Delta v_i)\), \(i = 1, 2, \ldots, n\). Возьмем точку \(P_i \in \Delta v_i\). \(f(P_i)\). \(\sum_{i=1}^n f(P_i)\Delta v_i\). Будем увеличивать число ячеек. Наиб. диаметр \(\Delta v_i \to 0\). Так как \(f(x, y, z)\) непрерывна в области \(V\):
\begin{equation}
    \lim_{diam \Delta v_i \to 0}{\sum_{i = 1}^n f(P_i)\Delta v_i} = \iiint\limits_V f(P)dv = \iiint\limits_V f(x, y, z)dxdydz
\end{equation}

\section{Правильная область}
\label{sec:Правильная область}

\begin{enumerate}
    \item Прямая, параллельная \(Oz\), пересекает \(G\) только в 2-х точках.
    \item \(\text{пр}_{xOy} V = D\) — правильная.
    \item Всякая часть области \(V\), отсеченная плоскостью, параллельной любой из координатной плоскости, также обладает свойствами 1) и 2).
\end{enumerate}

\section{Трехкратный интеграл по области}
\label{sec:Трехкратный интеграл по области}

\begin{equation}
    I_V = \int\limits_{a}^{b} \Big( \int\limits_{\varphi_1(x)}^{\varphi_2(x)} \Big[ \int\limits_{\xi_1(x, y)}^{\xi_2(x, y)} f(x, y, z) dz \Big] dy \Big) dx
\end{equation}

\section{Свойства трехкратного интеграла}
\label{sec:Свойства трехкратного интеграла}

% TODO: добавить свойства

\section{Замена переменных}
\label{sec:Замена переменных}

% TODO: добавить

\section{Двойной интеграл в полярных координатах}
\label{sec:Двойной интеграл в полярных координатах}

Преобразование двойного интеграла от прямоугольных координат \((x, y)\) к полярным координатам \((\rho, \theta)\), связанным с прямоугольными координатами соотношениями:
\begin{equation}
    x = \rho \cos{\theta}, \qquad y = \rho \sin{\theta}
\end{equation}

\begin{equation}
    \iint\limits_{D} f(x, y)dxdy = \iint\limits_{D} f(\rho \cos{\theta}, \rho \sin{\theta}) \rho d\rho d\theta
\end{equation}

Если область интегрирования \(D\) ограничена двумя лучами \(\theta = \alpha\) и \(\theta = \beta\), (\(\alpha < \beta\)), выходящими из полюса, и двумя кривыми \(\rho = \rho_1(\theta)\) и \(\rho = \rho_2(\theta)\), где \(\rho_1(\theta)\) и \(\rho_2(\theta)\) являются однозначными функциями при \(\theta \in [\alpha, \beta]\) и \(\rho_1(\theta) \leq \rho_2(\theta)\). Тогда двойной интеграл вычисляется по формуле:
\begin{equation}
    \iint\limits_{D} F(\rho, \theta) \rho d\rho d\theta = \int\limits_{\alpha}^{\beta} d\theta \int\limits_{\rho_1(\theta)}^{\rho_2(\theta)} F(\rho, \theta) \rho d\rho.
\end{equation}
где \(F(\rho, \theta) = f(\rho \cos{\theta}, \rho \sin{\theta})\), а внутренний интеграл считается для \(\theta = const\).

\section{Двойной интеграл в криволинейных координатах}
\label{sec:Двойной интеграл в криволинейных координатах}

Пусть двойной интеграл преобразуется от прямоугольных координат \((x, y)\) к криволинейным координатам \((u, v)\), связанными с прямоугольными координатами соотношениями:
\begin{equation}
    x = x(u, v), \qquad y = y(u, v),
\end{equation}
где \(x(u, v)\) и \(y(u, v)\) непрерывные вместе со своими частными производными первого порядка. Эти функции устанавливают взаимно однозначное и в обе стороны непрерывное соответствие между точками области \(D\) плоскости \(xOy\) и точками \(D'\) плоскости \(uO'v\) и определитель преобразования, называемый Якобианом, в области \(D'\) не обращается в \(0\):
\begin{equation}
    J =
    \begin{vmatrix}
        \frac{\partial x}{\partial u} & \frac{\partial x}{\partial v}
        \vspace{4pt}                                                  \\
        \frac{\partial y}{\partial u} & \frac{\partial y}{\partial v}
    \end{vmatrix}
\end{equation}

Тогда используется формула:
\begin{equation}
    \iint\limits_{D} f(x, y)dxdy = \iint\limits_{D'} f\big[ x(u, v), y(u, v) \big] |J| du dv.
\end{equation}

\section{Вычисление площади плоской фигуры}
\label{sec:Вычисление площади плоской фигуры}

Формула нахождения площади фигуры, ограниченной областью \(D\):
\begin{equation}
    S = \iint\limits_{D} dxdy.
\end{equation}

Если для \(D\) справедливо \(x \in [a, b]\), \(y \in [\varphi_1(x), \varphi_2(x)]\) , тогда
\begin{equation}
    S = \int\limits_{a}^{b} dx \int\limits_{\varphi_1(x)}^{\varphi_2(x)} dy.
\end{equation}

Если \(D\) определена в полярных координатах \(\theta \in [\alpha, \beta]\), \(\rho \in [\varphi(\theta), f(\theta)]\), то площадь \(D\) равна
\begin{equation}
    S = \iint\limits_{D} \rho d\rho d\theta = \int\limits_{\alpha}^{\beta} d\theta \int\limits_{\varphi_1(x)}^{\varphi_2(x)} \rho d\rho
\end{equation}

\section{Вычисление объема тела}
\label{sec:Вычисление объема тела}

Объем цилиндрического тела, ограниченного сверху непрерывной поверхностью \(z = f(x, y)\), снизу плоскостью \(z = 0\) и сбоку цилиндрической поверхностью, вырезающей на плоскости \(xOy\) область \(D\), вычисляется по формуле:
\begin{equation}
    V = \iint\limits_{D} f(x, y)dxdy.
\end{equation}

\section{Вычисление площади поверхности}
\label{sec:Вычисление площади поверхности}

Если\(z = f(x, y)\), \(D\) — проекция данной поверхности на плоскость \(xOy\):
\begin{equation}
    S = \iint\limits_{D} \sqrt{1 + \Big( \frac{\partial z}{\partial x} \Big)^2 + \Big( \frac{\partial z}{\partial y} \Big)^2} dxdy,
\end{equation}

Если \(x = f(y, z)\), \(D\) — проекция на \(yOz\):
\begin{equation}
    S = \iint\limits_{D} \sqrt{1 + \Big( \frac{\partial x}{\partial y} \Big)^2 + \Big( \frac{\partial x}{\partial z} \Big)^2}dydz
\end{equation}

Если \(y = f(x, z)\), \(D\) — проекция на \(xOz\):
\begin{equation}
    S = \iint\limits_{D} \sqrt{1 + \Big( \frac{\partial y}{\partial x} \Big)^2 + \Big( \frac{\partial y}{\partial z} \Big)^2}dxdz
\end{equation}

\section{Тройные интегралы}
\label{sec:Тройные интегралы}

% TODO: добавить определение
\begin{equation*}
    \iiint\limits_{T} f(x, y, z) dV = \lim_{\max d_k \to 0} \underbrace{\sum_{k=1}^n f(\xi_k, \eta_k, \zeta_k) \Delta V_k}_\text{интегральная сумма}
\end{equation*}

\subsection{Физический смысл}
\label{sub:Физический смысл}
Если \(f(x, y, z) > 0\) в области \(T\), то \(\iiint\limits_{T} f(x, y, z)\) представляет собой массу тела, занимающего объем \(T\) и имеющего переменную плотность \(\gamma = f(x, y, z)\).

\subsection{Тройной интеграл в декартовых координатах}
\label{sub:Тройной интеграл в декартовых координатах}

\begin{equation}
    \begin{gathered}
        \lets T: x \in [x_1, x_2], y \in [y_1(x), y_2(x)], z \in [z1(x, y), z_2(x, y)]: y_1, y_2, z_1, z_2 \in C \\
        \Downarrow \\
        \iiint\limits_{T} f(x, y, z) dV = \int\limits_{x_1}^{x_2} dx \int\limits_{y_1(x)}{y_2(x)} dy \int\limits_{z_1(x, y)}^{z_2(x, y)} f(x, y, z) dz.
    \end{gathered}
\end{equation}

% TODO: подправить определение
Если при вычислении тройного интеграла выполняется переход от \(x, y, z\) к \(u, v, w\), причем \(x = x(u, v, w)\), \(y = y(u, v, w)\), \(z = z(u, v, w)\), где функции \(x, y, z \in C^1\), то:
\begin{equation}
    J =
    \begin{vmatrix}
        \frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} & \frac{\partial x}{\partial w} \\
        \frac{\partial y}{\partial u} & \frac{\partial y}{\partial v} & \frac{\partial y}{\partial w} \\
        \frac{\partial z}{\partial u} & \frac{\partial z}{\partial v} & \frac{\partial z}{\partial w}
    \end{vmatrix}
    \neq 0
\end{equation}

\begin{equation}
    \iiint\limits_{T} f(x, y, z)dxdyz = \iiint\limits_{T'} f \big[ x(u, v, w), y(\cdot), z(\cdot) \big] \cdot |J| dudvdw.
\end{equation}

\subsection{Цилиндрические координаты}
\label{sub:Цилиндрические координаты}

\begin{equation}
    \begin{gathered}
        x, y, z \to \rho, \varphi, z : x = \rho\cos\varphi, y = \rho\sin\varphi, z = z \\
        (\rho \in [0, +\infty], \varphi \in [0, 2\pi], z \in [-\infty, +\infty]). \\
        \iiint\limits_{T} f(x, y, z)dxdydz = \int\limits_{\varphi_1}^{\varphi_2} d\varphi \int\limits_{\rho_1}^{\rho_2} \rho d\rho \int f(\rho \cos \varphi, \rho \sin \varphi, z) dz
    \end{gathered}
\end{equation}

\subsection{Сферические координаты}
\label{sub:Сферические координаты}

\begin{equation}
    \begin{gathered}
        x, y, z \to \rho, \varphi, \theta : x = \rho \sin \theta \cos \varphi, y = \rho \sin \theta \sin \varphi, z = \rho \cos \theta \\
        (\rho in [0, +\infty], \varphi \in [0, 2\pi], \theta \in [0, \pi]). \\
        J = \rho^2 \sin \theta \\
        \iiint\limits_{T} f(x, y, z) dxdydz = \int\limits_{\varphi_1}^{\varphi_2} d \varphi \int\limits_{\theta_1}^{\theta_2} \sin \theta \int\limits_{\rho_1}^{\rho_2}  f(\rho\sin{\theta\cos\varphi, \rho\sin\theta\sin\varphi,\rho\cos\theta}) d\rho
    \end{gathered}
\end{equation}


\chapter{Двойные интегралы}%
\label{cha:Двойные интегралы}

\section{Определение}%
\label{sec:Определение}

\(\lets f(x, y)\) определена в ограниченной замкнутой области \(D\) плоскости \(xOy\). Разобьем область \(D\) произвольным образом на \(n\) элементарных областей, с площадями \(\Delta S_1, \Delta S_2, \ldots, \Delta S_n\) и диаметрами \(d_1, d_2, \ldots, d_n\) (диаметр области — наиб. расстояние между двумя точками границы этой области). Выберем в каждой элементарной области произвольную точку \(P_i (x_i, y_i)\) и умножим значение функции \(f\) в точке \(P_i\) на площадь этой области.

Интегральная сумма для \(f(x, y)\) по области \(D\):
\begin{equation}
    \sum_{i=1}^n f(x_i, y_i) \Delta S_i
\end{equation}

Если при \(\max{d_i} \to 0\) интегральная сумма имеет опред. конечный предел
\begin{equation}
    I = \lim_{\max{d_i} \to 0}{\sum_{i = 1}^n f(x_i, y_i) \Delta S_i},
\end{equation}
независящий от способа разбиения \(D\) на эл. области и способа выбора \(P_i\), то этот предел называется двойным интегралом \(f(x, y)\) в области \(D\) и обозначается:
\begin{equation}
    \iint\limits_D f(x, y) dS = \lim_{\max{d_i} \to 0}{\sum_{i = 1}^n f(x_i, y_i) \Delta S_i}
\end{equation}

Если \(f(x, y) > 0\), то двойной интеграл равен объему цилиндрического тела, ограниченного сверху поверхностью \(z = f(x, y)\) с образующими параллельными оси \(Oz\) и снизу областью \(D\), которая лежит в плоскости \(xOy\).

\section{Свойства двойного интеграла}%
\label{sec:Свойства двойного интеграла}

\begin{property}
    \begin{equation}
        \iint\limits_D [f(x, y) \pm g(x, y)]dS = \iint\limits_D f(x, y)dS \pm \iint\limits_D g(x, y)dS
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        \begin{gathered}
            \iint\limits_D [f(x, y) \pm g(x, y)]dS =
            \lim_{\max{d_i} \to 0}{\sum_{i = 1}^n [f(x_i, y_i) \pm g(x_i, y_i)] \Delta S_i} = \\ =
            \lim_{\max{d_i} \to 0}{\sum_{i = 1}^n f(x_i, y_i) \Delta S_i} \pm
            \lim_{\max{d_i} \to 0}{\sum_{i = 1}^n g(x_i, y_i) \Delta S_i} = \\ =
            \iint\limits_{D} f(x, y) dS \pm \iint\limits_{D} g(x, y) dS.
        \end{gathered}
    \end{equation}
\end{proof}

\begin{property}
    \begin{equation}
        \iint\limits_D \lambda f(x, y)dS = \lambda \iint\limits_D f(x, y)dS, \qquad \lambda = const
    \end{equation}
\end{property}

\begin{proof}
    \begin{equation}
        \iint\limits_{D} \lambda f(x, y) dS =
        \lim_{\max_{d_i} \to 0} \sum_{i = 1}^n \lambda f(x_i, y_i) \Delta S_i =
        \lambda \lim_{\max_{d_i} \to 0} \sum_{i = 1}^n f(x_i, y_i) \Delta S_i =
        \lambda \iint\limits_{D} f(x, y) dS.
    \end{equation}
\end{proof}

\begin{property}
    Если \(D\) разбита на \(D_1\) и \(D_2\), то
    \begin{equation}
        \iint\limits_D f(x, y)dS = \iint\limits_{D_1} f(x, y)dS + \iint\limits_{D_2} f(x, y)dS
    \end{equation}
\end{property}

\begin{proof}
    Пусть \(D_1\) разбита на
    \begin{equation}
        D_{1,1}, D_{1,2}, \ldots, D_{1,n_1},
    \end{equation}
    а \(D_2\) разбита на
    \begin{equation}
        D_{2,1}, D_{2,2}, \ldots, D_{2,n_2}.
    \end{equation}
    Тогда объединение этих разбиений даст разбиение области \(D\):
    \begin{equation}
        D = \Big( \bigcup_{i_1 = 1}^{n_1} D_{1, i_1} \Big) \cup \Big( \bigcup_{i_2 = 1}^{n_2} D_{2, i_2} \Big)
    \end{equation}
    на \(n_1\) и \(n_2\) подобластей. Интегральная сумма \(D\) равна сумме по \(D_1\) и \(D_2\):
    \begin{equation}
        \sum_{i=1}^{n_1 + n_2} f(x_i, y_i) \Delta S_i = \sum_{i_1 = 1}^{n_1} f(x_{i_1}, y_{i_1}) \Delta S_{i_1} + \sum_{i_2 = 1}^{n_2} f(x_{i_2}, y_{i_2}) \Delta S_{i_2}.
    \end{equation}
    Перейдя к пределу при \(\max d_i \to 0\) получим требуемое неравенство.
\end{proof}

\begin{property}
    Оценка двойного интеграла
    \begin{equation}
        m \leq f(x, y) \leq M \implies mS \leq \iint\limits_D f(x, y)dS \leq MS,
    \end{equation}
    где \(S\) — площадь области \(D\), а \(m\) и \(M\) — наиб. и наим. значения \(f(x, y)\) в области \(D\) соотв.
\end{property}

\begin{proof}
    \begin{equation}
        \begin{gathered}
            m \leq f(x, y) \leq M
            \implies
            \sum_{i = 1}^n m \Delta S_i \leq \sum_{i = 1}^n f(x_i, y_i) \Delta S_i \leq \sum_{i = 1}^n M \Delta S_i.
            \implies \\ \implies
            m \sum_{i = 1}^n \Delta S_i \leq \sum_{i = 1}^n f(x_i, y_i) \Delta S_i \leq M \sum_{i = 1}^n \Delta S_i
            \implies
            mS \leq \iint\limits_{D} f(x, y) dS \leq MS.
        \end{gathered}
    \end{equation}
\end{proof}

\section{Правила вычисления двойного интеграла}%
\label{sec:Правила вычисления двойного интеграла}

\subsection{Способ 1}%
\label{sub:Способ 1}

Область интегрирования \(D\) ограничена слева и справа прямыми \(x = a\), \(x = b\), \(a < b\), а снизу и сверху — непрерывными кривыми \(y = \varphi_1(x)\) и \(y = \varphi_2(x)\), \(\varphi_1(x) \leq \varphi_2(x)\), каждая из которых пересекается вертикальной прямой только в одной точке:
\begin{equation}
    \iint\limits_D f(x, y)dxdy = \underbrace{\int\limits_a^b dx}_\text{повторный} \underbrace{\int\limits_{\varphi_1(x)}^{\varphi_2(x)} f(x, y)dy}_\text{внутренний},
\end{equation}
причем сначала вычисляется внутренний интеграл, в котором \(x = const\), а далее — повторный интеграл.

\subsection{Способ 2}%
\label{sub:Способ 2}

Область интегрирования \(D\) ограничена снизу и сверху \(y = c\), \(y = d\), \(c < d\), а слева и справа — непрерывными кривыми \(x = \psi_1(y)\) и \(x = \psi_2(y)\), \(\psi_1(y) \leq \psi_2(y)\), каждая из которых пересекается горизонтальной прямой только в одной точке:
\begin{equation}
    \iint\limits_D = f(x, y)dxdy = \int\limits_c^d dy \int\limits_{\psi_1(y)}^{\psi_2(y)} f(x, y)dx
\end{equation}

\subsection{Алгоритм решения двойного интеграла}%
\label{sub:Алгоритм решения двойного интеграла}

\begin{enumerate}
    \item {Построить чертеж для \(D\).}
    \item {Расставить пределы интегрирования и перейти к повторным интегралам.}
    \item {Вычислить внутренний интеграл.}
    \item {Вычислить внешний интеграл и получить ответ.}
\end{enumerate}


\section{Криволинейные координаты}
\label{sec:Криволинейные координаты}

Пусть существует область \(D\) в трехмерном пространстве. Поставим в соответствие каждой точке \(M \in D\), имеющей координаты \((x, y, z)\), тройку чисел \((q_1, q_2, q_3)\) из некоторого множества \(Q\) таким образом, что т. \(M\) однозначно определяется тройкой чисел \((q_1, q_2, q_3)\). Значит, ее декартовы координаты \((x, y, z)\) являются функциями чисел:
\begin{equation}
    x = x(q_1, q_2, q_3),
    \qquad
    y = y(q_1, q_2, q_3),
    \qquad
    z = z(q_1, q_2, q_3).
\end{equation}

Учитывая, что
\begin{equation}
    \vv{r} = x \vv{i} + y \vv{j} + z \vv{k},
\end{equation}

три скалярные функции можно заменить одной векторной
\begin{equation}
    \vv{r} = \vv{r}(q_1, q_2, q_3).
\end{equation}

Будем считать, что \(\vv{r} \in C^1\) и \(J \neq 0\). Тогда существует отображение
\begin{equation}
    q_i = q_i(x, y, z), (i = 1, 2, 3).
\end{equation}

Числа \((q_1, q_2, q_3)\) — это \textbf{криволинейные координаты} т. \(M\), а ее отображения — \textbf{криволинейная система координат}.

Если в отображении зафиксировать какие-либо две величины, например, \(q_2\) и \(q_3\), тогда оно будет определять множество точек, которое называется координатной \(q_1\)-линией. Аналогично получаются \(q_2\) и \(q_3\) линии.

За положительное направление этих координатных линий принимается такое направление, вдоль которого соответствующая переменная возрастает. Очевидно, что через т. \(M\) можно провести 3 взаимно пересекающиеся координатные линии, которые в общем случае суть некоторые кривые.

Пусть координаты \(q_2\) и \(q_3\) — фиксированы, т. е. \(q_2 = q_2^0\), \(q_3 = q_3^0\). Тогда отображение
\begin{equation}
    \vv{r} = \vv{r}(q_1, q_2^0, q_3^0)
\end{equation}

есть функция переменной \(q_1\), а ее производная \(\partial \vv{r} / \partial q_1\) в т. \(M\) — это касательный вектор \(\vv{r_1}\) к \(q_1\)-линии в этой точке. Таким образом
\begin{equation}
    \vv{r_j} = \frac{\partial \vv{r}}{\partial q_j}, (j = 1, 2, 3).
\end{equation}

Очевидно, что \(\vv{r_j}\) имеет компоненты
\begin{equation}
    \vv{r_j} =
    \Big(
    \frac{\partial x}{\partial q_j},
    \frac{\partial y}{\partial q_j},
    \frac{\partial z}{\partial q_j}
    \Big).
\end{equation}

Система криволинейных координат называется \textbf{ортогональной}, если в любой точке векторы \(\vv{r_1}\), \(\vv{r_2}\), \(\vv{r_3}\) попарно ортогональны, то есть
\begin{equation}
    (\vv{r_i}, \vv{r_j}) = 0, i \neq j.
\end{equation}

Обозначим за \(H_i\) модуль вектора \(\vv{r_i}\), то есть
\begin{equation}
    H_i = |\vv{r_i}| =
    \sqrt{
        \Big( \frac{\partial x}{\partial q_i} \Big)^2 +
        \Big( \frac{\partial y}{\partial q_i} \Big)^2 +
        \Big( \frac{\partial z}{\partial q_i} \Big)^2
    }.
\end{equation}

Числа \(H_i\) называются \textbf{метрическими коэффициентами} или \textbf{коэффициентами Ламэ}.

Единичные орты осей определяются равенствами
\begin{equation}
    \vv{e_i} = \frac{\vv{r_i}}{H_i} = \frac{1}{H_i} \frac{\partial \vv{r}}{\partial q},
    (i = 1, 2, 3).
\end{equation}

Выразим теперь элемент длины дуги, элемент криволинейной поверхности и элемент объема. Напомним, что в декартовых координатах квадрат элемента длины \(dl^2\) равен
\begin{equation}
    dl^2 = dx^2 + dy^2 + dz^2.
\end{equation}

Так как
\begin{equation}
    \begin{gathered}
        dx = \frac{\partial x}{\partial q_1} dq_1 + \frac{\partial x}{\partial q_2} dq_2 + \frac{\partial x}{\partial q_3} dq_3, \\
        dy = \frac{\partial y}{\partial q_1} dq_1 + \frac{\partial y}{\partial q_2} dq_2 + \frac{\partial y}{\partial q_3} dq_3, \\
        dz = \frac{\partial z}{\partial q_1} dq_1 + \frac{\partial z}{\partial q_2} dq_2 + \frac{\partial z}{\partial q_3} dq_3,
    \end{gathered}
\end{equation}

Квадрат элемента длины равен
\begin{equation}
    dl^2 = H_1^2 dq_1^2 + H_2^2 dq_2^2 + H_3^2 dq_3^3.
\end{equation}

Значит элемент длины дуги координатной линии равен
\begin{equation}
    dl_i = H_i dq_i.
\end{equation}

Из этого следует, что элемент криволинейной поверхности \(d\sigma_{ij}\), образованный \(i\)-й и \(j\)- координатной линией, и элемент объема \(dV\) равны
\begin{equation}
    d\sigma_{ij} = H_i H_j dq_i dq_j,
    \qquad
    dV = H_1 H_2 H_3 dq_1 dq_2 dq_3.
\end{equation}

\section{Общий случай замены переменных в двойном интеграле}
\label{sec:Общий случай замены переменных в двойном интеграле}

Пусть функции \(x = \varphi_1(u, v)\) и \(y = \varphi_2(u, v)\) осуществляют взаимно-однозначное непрерывно дифференцируемое отображение области \(D'\) плоскости \(uO'v\) на область \(D\) плоскости \(xOy\). Тогда существует обратное непрерывно дифференцируемое отображение \(u = \eta_1(x, y)\) и \(v = \eta_2(x, y)\) области \(D\) на область \(D'\), где определитель преобразования, называемый \textit{якобианом}, в области \(D'\) не равен нулю:
\begin{equation}
    J =
    \begin{vmatrix}
        \dfrac{\strut \partial \varphi_1}{\strut \partial u} & \dfrac{\strut \partial \varphi_1}{\strut \partial v} \\
        \dfrac{\strut \partial \varphi_2}{\strut \partial u} & \dfrac{\strut \partial \varphi_2}{\strut \partial v}
    \end{vmatrix}
    \neq 0.
\end{equation}
Тогда справедлива формула:
\begin{equation}
    \iint\limits_{D} f(x, y) dxdy = \iint\limits_{D'} f [\varphi_1(u, v), \varphi_2(u, v)] |J|dudv.
\end{equation}

Рассмотрим пример с полярными координатами, где
\begin{equation}
    x = \varphi_1(\rho, \theta) = \rho \cos \theta,
    \qquad
    y = \varphi_2(\rho, \theta) = \rho \sin \theta.
\end{equation}

Якобиан равен
\begin{equation}
    J =
    \begin{vmatrix}
        \dfrac{\strut \partial \varphi_1}{\strut \partial \rho} & \dfrac{\strut \partial \varphi_1}{\strut \partial \theta} \\
        \dfrac{\strut \partial \varphi_2}{\strut \partial \rho} & \dfrac{\strut \partial \varphi_2}{\strut \partial \theta}
    \end{vmatrix}
    =
    \begin{vmatrix}
        \cos \theta & -\rho \sin \theta \\
        \sin \theta & \rho \cos \theta
    \end{vmatrix}
    = \rho \cos^2 \theta + \rho \sin^2 \theta = \rho.
\end{equation}

Тогда двойной интеграл равен
\begin{equation}
    \iint\limits_{D} f(x, y)dxdy = \iint\limits_{D'} f(\rho \cos \theta, \rho \sin \theta) \rho d\rho d\theta.
\end{equation}



\end{document}
